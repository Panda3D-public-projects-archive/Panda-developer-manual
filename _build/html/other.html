

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>File formats, specifications and similar &mdash; Panda3D dev Manual 0.0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Panda3D dev Manual 0.0.1 documentation" href="index.html"/>
        <link rel="next" title="Miscellaneous and F.A.Q." href="misc and FAQ.html"/>
        <link rel="prev" title="Source tree" href="source tree.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Panda3D dev Manual
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="source tree.html">Source tree</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">File formats, specifications and similar</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-graphicsengine">The GraphicsEngine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#graphicspipe">GraphicsPipe</a></li>
<li class="toctree-l3"><a class="reference internal" href="#graphicswindow-and-graphicsbuffer">GraphicsWindow and GraphicsBuffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#graphicsstateguardian">GraphicsStateGuardian</a></li>
<li class="toctree-l3"><a class="reference internal" href="#renderinga-frame">Renderinga frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-a-graphicsengine-to-create-windows-and-buffers">Using a GraphicsEngine to create windows and buffers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sharinggraphics-contexts">Sharinggraphics contexts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#closingwindows">Closingwindows</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ppython">ppython</a></li>
<li class="toctree-l2"><a class="reference internal" href="#panda-audio-documenation">Panda Audio Documenation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#audiomanagerand-audiosound">AudioManagerand AudioSound</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exampleusage">ExampleUsage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#codingstyle">Codingstyle</a></li>
<li class="toctree-l2"><a class="reference internal" href="#collisionflags">COLLISIONFLAGS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#eggpalettize">eggpalettize</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#howto-use-egg-palettize">HOWTO USE EGG_PALETTIZE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#groupingegg-files">GROUPINGEGG FILES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#controllingtexture-parameters">CONTROLLINGTEXTURE PARAMETERS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#runningegg-palettize">RUNNINGEGG-PALETTIZE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#whenthings-go-wrong">WHENTHINGS GO WRONG</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#thephilosophy-of-egg-files">THEPHILOSOPHY OF EGG FILES</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#generalegg-syntax">GENERALEGG SYNTAX</a></li>
<li class="toctree-l3"><a class="reference internal" href="#localinformation-entries">LOCALINFORMATION ENTRIES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#globalinformation-entries">GLOBALINFORMATION ENTRIES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#geometryentries">GEOMETRYENTRIES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parametricdescription-entries">PARAMETRICDESCRIPTION ENTRIES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#morphdescription-entries">MORPHDESCRIPTION ENTRIES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#groupingentries">GROUPINGENTRIES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#groupbinary-attributes">GROUPBINARY ATTRIBUTES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#groupscalars">GROUPSCALARS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#othergroup-attributes">OTHERGROUP ATTRIBUTES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#collide-name-type-flags"><Collide>name { type [flags] }</a></li>
<li class="toctree-l3"><a class="reference internal" href="#objecttype-type"><ObjectType>{type}</a></li>
<li class="toctree-l3"><a class="reference internal" href="#miscellaneous">MISCELLANEOUS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#animationstructure">ANIMATIONSTRUCTURE</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#howto-control-render-order">HOWTO CONTROL RENDER ORDER</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cullbins">CULLBINS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#howto-make-multipart-actor">Howto make multipart actor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#multipartactors-vs-half-body-animation">MULTIPARTACTORS vs. HALF-BODY ANIMATION</a></li>
<li class="toctree-l3"><a class="reference internal" href="#broadoverview">BROADOVERVIEW</a></li>
<li class="toctree-l3"><a class="reference internal" href="#moredetails">MOREDETAILS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nuts-and-bolts">NUTS AND BOLTS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#multigenmodel-flags">MULTIGENMODEL FLAGS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#handles">HANDLES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#behaviors">BEHAVIORS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#properties">PROPERTIES</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#multi-texturing-in-maya">Multi-Texturing in Maya</a></li>
<li class="toctree-l2"><a class="reference internal" href="#config">Config</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-the-prc-files">Using the prc files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#defining-config-variables">Defining config variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#directly-assigning-config-variables">Directly assigning config variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#querying-config-variables">Querying config variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#re-reading-prc-files">Re-reading prc files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#runtime-prc-file-management">Runtime prc file management</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compile-time-options-for-finding-prc-files">Compile-time options for finding prc files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#executable-prc-files">Executable prc files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#signed-prc-files">Signed prc files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="misc and FAQ.html">Miscellaneous and F.A.Q.</a></li>
<li class="toctree-l1"><a class="reference internal" href="Appendix.html">Appendix</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Panda3D dev Manual</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>File formats, specifications and similar</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/other.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="file-formats-specifications-and-similar">
<span id="file-formats-specifications-and-similar"></span><h1>File formats, specifications and similar<a class="headerlink" href="#file-formats-specifications-and-similar" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-graphicsengine">
<span id="the-graphicsengine"></span><h2>The GraphicsEngine<a class="headerlink" href="#the-graphicsengine" title="Permalink to this headline">¶</a></h2>
<p>The GraphicsEngine is where it all begins. Thereis only one, global, GraphicsEngine in an application, and its job isto keep all of the pointers to your open windows and buffers, andalso to manage the task of doing the rendering, for all of the openwindows and buffers. Panda normally creates a GraphicsEngine for youat startup, which is available as <code class="docutils literal"><span class="pre">base.graphicsEngine</span></code>.There is usually no reason to create a second GraphicsEngine.</p>
<p>Note also that the following interfaces arestrictly for the advanced user. Normally, if you want</p>
<p>to create a new window or an offscreen buffer forrendering, you would just use the</p>
<p>base.openWindow()</p>
<p>or</p>
<p>window.makeTextureBuffer()</p>
<p>interfaces, which handle all of the details foryou automatically.</p>
<p>However, please continue reading if you want tounderstand in detail how Panda manages</p>
<p>windows and buffers, or if you have special needsthat are not addressed by the above</p>
<p>convenience methods.</p>
<div class="section" id="graphicspipe">
<span id="graphicspipe"></span><h3>GraphicsPipe<a class="headerlink" href="#graphicspipe" title="Permalink to this headline">¶</a></h3>
<p>Each application will also need at least oneGraphicsPipe. The GraphicsPipe encapsulates the particular API usedto do rendering. For instance, there is one GraphicsPipe class forOpenGL rendering, and a different GraphicsPipe for DirectX. Althoughit is possible to create a GraphicsPipe of a specific type directly,normally Panda will create a default GraphicsPipe for you at startup,which is available in <code class="docutils literal"><span class="pre">base.pipe</span></code>.</p>
<p>The GraphicsPipe object isn&#8217;t often used directly,except to create the individual GraphicsWindow and GraphicsBufferobjects.</p>
</div>
<div class="section" id="graphicswindow-and-graphicsbuffer">
<span id="graphicswindow-and-graphicsbuffer"></span><h3>GraphicsWindow and GraphicsBuffer<a class="headerlink" href="#graphicswindow-and-graphicsbuffer" title="Permalink to this headline">¶</a></h3>
<p>The GraphicsWindow class is the class thatrepresents a single onscreen window for rendering. Panda normallyopens a default window for you at startup, which is available in<code class="docutils literal"><span class="pre">base.win</span></code>. You can create as manyadditional windows as you like. (Note, however, that some graphicsdrivers incur a performance penalty when multiple windows are opensimultaneously.)</p>
<p>Similarly, GraphicsBuffer is the class thatrepresents a hidden, offscreen buffer for rendering special offscreeneffects, such as render-to-texture. It is common for an applicationto have many offscreen buffers open at once.</p>
<p>Both classes inherit from the base classGraphicsOutput, which contains all of the code common to rendering toa window or offscreen buffer.</p>
</div>
<div class="section" id="graphicsstateguardian">
<span id="graphicsstateguardian"></span><h3>GraphicsStateGuardian<a class="headerlink" href="#graphicsstateguardian" title="Permalink to this headline">¶</a></h3>
<p>The GraphicsStateGuardian, or GSG for short,represents the actual graphics context. This class manages the actualnuts-and-bolts of drawing to a window; it manages the loading oftextures and vertex buffers into graphics memory, and has thefunctions for actually drawing triangles to the screen. (During theprocess of rendering the frame, the &#8220;graphics state&#8221;changes several times; the GSG gets its name from the fact that mostof its time is spent managing this graphics state.)</p>
<p>You would normally never call any methods on theGSG directly; Panda handles all of this for you, via theGraphicsEngine. This is important, because in some modes, the GSG mayoperate almost entirely in a separate thread from all of yourapplication code, and it is important not to interrupt that threadwhile it might be in the middle of drawing.</p>
<p>Each GraphicsOutput object keeps a pointer to theGSG that will be used to render that window or buffer. It is possiblefor each GraphicsOutput to have its own GSG, or it is possible toshare the same GSG between multiple different GraphicsOutputs.Normally, it is preferable to share GSG&#8217;s, because this tends to bemore efficient for managing graphics resources.</p>
<p>Consider the following diagram to illustrate therelationship between these classes. This shows a typical applicationwith one window and two offscreen buffers:</p>
<p>|                |  GraphicsPipe  |                |
| &#8212;&#8212;&#8212;&#8212;-: | :&#8212;&#8212;&#8212;&#8212;: | &#8212;&#8212;&#8212;&#8212;&#8211; |
|              / |       |       | \              |
| GraphicsOutput | GraphicsOutput | GraphicsOutput |
|             | |       |       | |             |
|            GSG |      GSG       | GSG            |</p>
<p>The GraphicsPipe was used to create each of thethree GraphicsOutputs, of which one is a GraphicsWindow, and theremaining two are GraphicsBuffers. Each GraphicsOutput has a pointerto the GSG that will be used for rendering. Finally, theGraphicsEngine is responsible for managing all of these objects.</p>
<p>In the above illustration, each window and bufferhas its own GSG, which is legal, although it&#8217;s usually better toshare the same GSG across all open windows and buffers.</p>
</div>
<div class="section" id="renderinga-frame">
<span id="renderinga-frame"></span><h3>Renderinga frame<a class="headerlink" href="#renderinga-frame" title="Permalink to this headline">¶</a></h3>
<p>There is one key interface to rendering each frameof the graphics simulation:</p>
<p>base.graphicsEngine.renderFrame()</p>
<p>This method causes all open GraphicsWindows andGraphicsBuffers to render their contents for</p>
<p>the current frame. In order for Panda3D to renderanything, this method must be called once per frame. Normally, thisis done automatically by the task &#8220;igloop&#8221;, which iscreated when you start</p>
<p>Panda.</p>
</div>
<div class="section" id="using-a-graphicsengine-to-create-windows-and-buffers">
<span id="using-a-graphicsengine-to-create-windows-and-buffers"></span><h3>Using a GraphicsEngine to create windows and buffers<a class="headerlink" href="#using-a-graphicsengine-to-create-windows-and-buffers" title="Permalink to this headline">¶</a></h3>
<p>In order to render in Panda3D, you need aGraphicsStateGuardian , and either a GraphicsWindow</p>
<p>(for rendering into a window) or a GraphicsBuffer(for rendering offscreen). You cannot create or destroy these objectsdirectly; instead, you must use interfaces on the GraphicsEngine tocreate them. Before you can create either of the above, you need tohave a GraphicsPipe, which specifies</p>
<p>the particular graphics API you want to use (e.g.OpenGL or DirectX). The default GraphicsPipe</p>
<p>specified in your Config.prc file has already beencreated at startup, and can be accessed by</p>
<p>base.pipe.</p>
<p>Now that you have a GraphicsPipe and aGraphicsEngine, you can create a</p>
<p>GraphicsStateGuardian object. This objectcorresponds to a single graphics context on the</p>
<p>graphics API, e.g. a single OpenGL context. (Thecontext owns all of the OpenGL or DirectX</p>
<p>objects like display lists, vertex buffers, andtexture objects.) You need to have at least one</p>
<p>GraphicsStateGuardian before you can create aGraphicsWindow:</p>
<p>myGsg=base.graphicsEngine.makeGsg(base.pipe)</p>
<p>Now that you have a GraphicsStateGuardian, you canuse it to create an onscreen</p>
<p>GraphicsWindow or an offscreen GraphicsBuffer:</p>
<p>base.graphicsEngine.makeWindow(gsg, name,sort)</p>
<p>base.graphicsEngine.makeBuffer(gsg, name,sort, xSize, ySize, wantTexture)</p>
<p>gsg is the GraphicsStateGuardian, name Is anarbitrary name you want to assign to the window/</p>
<p>buffer, and sort is an integer that determines theorder in which the windows/buffers will be</p>
<p>rendered. The buffer specific arguments xSize andySize decide the dimensions of the buffer, and</p>
<p>wantTexture should be set to True if you want toretrieve a texture from this buffer later on.</p>
<p>You can also use</p>
<p>graphicsEngine.makeParasite(host,name,sort,xSize,ySize)</p>
<p>where host is a GraphicsOutput object. It createsa buffer but it does not allocate room for itself. Instead it rendersto the framebuffer of host. It effectively has wantTexture set toTrue so you can</p>
<p>retrieve a texture from it later on. See TheGraphicsOutput class and Graphics Buffers and Windows</p>
<p>for more information.</p>
<p>myWindow=base.graphicsEngine.makeWindow(myGsg,&#8221;HelloWorld&#8221;,0)</p>
<p>myBuffer=base.graphicsEngine.makeBuffer(myGsg,&#8221;HiWorld&#8221;,0,800,600,True)</p>
<p>myParasite=base.graphicsEngine.makeBuffer(myBuffer,&#8221;Ima leech&#8221;,0,800,600)</p>
<p>Note: if youwant the buffers to be visible add show-buffers true to yourconfiguration file.</p>
<p>This causes the buffers to be opened as windowsinstead, which is useful while debugging.</p>
</div>
<div class="section" id="sharinggraphics-contexts">
<span id="sharinggraphics-contexts"></span><h3>Sharinggraphics contexts<a class="headerlink" href="#sharinggraphics-contexts" title="Permalink to this headline">¶</a></h3>
<p>It is possible to share the sameGraphicsStateGuardian among multiple different</p>
<p>GraphicsWindows and/or GraphicsBuffers; if you dothis, then the graphics context will be used</p>
<p>to render into each window one at a time. This isparticularly useful if the different windows</p>
<p>will be rendering many of the same objects, sincethen the same texture objects and vertex</p>
<p>buffers can be shared between different windows.</p>
<p>It is also possible to use a differentGraphicsStateGuardian for each different window. This</p>
<p>means that if a particular texture is to berendered in each window, it will have to be loaded</p>
<p>into graphics memory twice, once in each context,which may be wasteful. However, there are</p>
<p>times when this may be what you want to do, forinstance if you have multiple graphics cards</p>
<p>and you want to to render to both of themsimultaneously. (Note that the actual support for</p>
<p>simultaneously rendering to multiple graphicscards is currently unfinished in Panda at the</p>
<p>time of this writing, but the API has beendesigned with this future path in mind.)</p>
</div>
<div class="section" id="closingwindows">
<span id="closingwindows"></span><h3>Closingwindows<a class="headerlink" href="#closingwindows" title="Permalink to this headline">¶</a></h3>
<p>To close a specific window or buffer you useremoveWindow(window). To close all windows</p>
<p>removeAllWindows()</p>
<p>base.graphicsEngine.removeWindow(myWindow)</p>
<p>base.graphicsEngine.removeAllWindows()</p>
<p>More about GraphicsEngine</p>
<p>Here is some other useful functionality of theGraphicsEngine class.</p>
<p>GetNumWindows() Returns the number of windows andbuffers that this GraphicsEngine</p>
<p>object is managing. IsEmpty() Returns True if thisGraphicsEngine is not managing any windows or buffers. See API foradvanced functionality of GraphicsEngine and GraphicsStateGuardianclass.</p>
</div>
</div>
<div class="section" id="ppython">
<span id="ppython"></span><h2>ppython<a class="headerlink" href="#ppython" title="Permalink to this headline">¶</a></h2>
<p>ppython.exe is used for startingPanda3D. Basicly it is only duplicated copy of python.exe renamed soyou don&#8217;t mix Panda&#8217;s python with other python on your PATH</p>
</div>
<div class="section" id="panda-audio-documenation">
<span id="panda-audio-documenation"></span><h2>Panda Audio Documenation<a class="headerlink" href="#panda-audio-documenation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="audiomanagerand-audiosound">
<span id="audiomanagerand-audiosound"></span><h3>AudioManagerand AudioSound<a class="headerlink" href="#audiomanagerand-audiosound" title="Permalink to this headline">¶</a></h3>
<p>The AudioManager is a combination of a file cacheand a category</p>
<p>of sounds (e.g. sound effects, battle sounds, ormusic).</p>
<p>The first step is to decide which AudioManager touse and load it.</p>
<p>Once you have an AudioManager (e.g.effectsManager), a call to</p>
<p>get_sound(<file>) on that manager should getyou an AudioSound</p>
<p>(e.g. mySound = effectsManager.getSound(&#8220;bang&#8221;)).</p>
<p>After getting a sound from an AudioManager, youcan tell the sound</p>
<p>change its volume, loop, start time, play, stop,etc.  There is no</p>
<p>need to involve the AudioManager explicitly inthese operations.</p>
<p>Simply delete the sound when you&#8217;re done with it. (The AudioSound</p>
<p>knows which AudioManager it is associated with,and will do the right</p>
<p>thing).</p>
<p>The audio system, provides an API for the rest ofPanda; and leaves a</p>
<p>lot of leaway to the low level sound system.  Thisis good and bad.</p>
<p>On the good side: it&#8217;s easier to understand, andit allows for widely</p>
<p>varrying low level systems.  On the bad side: itmay be harder to keep</p>
<p>the behavior consistent accross implementations(please try to keep</p>
<p>them consistent, when adding an implementation).</p>
</div>
<div class="section" id="exampleusage">
<span id="exampleusage"></span><h3>ExampleUsage<a class="headerlink" href="#exampleusage" title="Permalink to this headline">¶</a></h3>
<p><strong>PythonExample:</strong></p>
<p>​   effects=AudioManager.createAudioManager()</p>
<p>​   music=AudioManager.createAudioManager()</p>
<p>​   bang=effects.load(&#8220;bang&#8221;)</p>
<p>​   background=music.load(&#8220;background_music&#8221;)</p>
<p>​   background.play()</p>
<p>​   bang.play()</p>
<p><strong>C++Example:</strong></p>
<p>​   AudioManagereffects=AudioManager::create_AudioManager();</p>
<p>​   AudioManagermusic=AudioManager::create_AudioManager();</p>
<p>​   bang=effects.get_sound(&#8220;bang&#8221;);</p>
<p>​   background=music.get_sound(&#8220;background_music&#8221;);</p>
<p>​   background.play();</p>
<p>​   bang.play();</p>
</div>
</div>
<div class="section" id="codingstyle">
<span id="codingstyle"></span><h2>Codingstyle<a class="headerlink" href="#codingstyle" title="Permalink to this headline">¶</a></h2>
<p>Almostany programming language gives a considerable amount of freedom</p>
<p>tothe programmer in style conventions.  Most programmers eventually</p>
<p>developa personal style and use it as they develop code.</p>
<p>Whenmultiple programmers are working together on one project, this</p>
<p>canlead to multiple competing styles appearing throughout the code.</p>
<p>Thisis not the end of the world, but it does tend to make the code</p>
<p>moredifficult to read and maintain if common style conventions are</p>
<p>notfollowed throughout.</p>
<p>Itis much better if all programmers can agree to use the same style</p>
<p>whenworking together on the same body of work.  It makes reading,</p>
<p>understanding,and extending the existing code much easier and faster</p>
<p>foreveryone involved.  This is akin to all of the animators on a</p>
<p>featurefilm training themselves to draw in one consistent style</p>
<p>throughoutthe film.</p>
<p>Often,there is no strong reason to prefer one style over another,</p>
<p>exceptthat at the end of the day just one must be chosen.</p>
<p>Thefollowing lays out the conventions that we have agreed to use</p>
<p>withinPanda.  Most of these conventions originated from an</p>
<p>amalgamationof the different styles of the first three programmers to</p>
<p>domajor development in Panda.  The decisions were often arbitrary,</p>
<p>andsome may object to the particular choices that were made.</p>
<p>Althoughdiscussions about the ideal style for future work are still</p>
<p>welcome,considerable code has already been written using these</p>
<p>existingconventions, and the most important goal of this effort is</p>
<p>consistency. Thus, changing the style at this point would require</p>
<p>changingall of the existing code as well.</p>
<p>Notethat not all existing Panda code follows these conventions.  This</p>
<p>isunfortunate, but it in no way constitutes an argument in favor of</p>
<p>abandoningthe conventions.  Rather, it means we should make an effort</p>
<p>tobring the older code into compliance as we have the opportunity.</p>
<p>Naturally,these conventions only apply to C and C++ code; a</p>
<p>completelydifferent set of conventions has been established for</p>
<p>Pythoncode for the project, and those conventions will not be</p>
<p>discussedhere.</p>
<p>SPACING:</p>
<p>Notab characters should ever appear in a C++ file; we use only space</p>
<p>charactersto achieve the appropriate indentation.  Most editors can</p>
<p>beconfigured to use spaces instead of tabs.</p>
<p>Weuse two-character indentation.  That is, each nested level of</p>
<p>indentationis two characters further to the right than the enclosing</p>
<p>level.</p>
<p>Spacesshould generally surround operators, e.g. i + 1 instead of i+1.</p>
<p>Spacesfollow commas in a parameter list, and semicolons in a for</p>
<p>statement. Spaces are not placed immediately within parentheses;</p>
<p>e.g.foo(a, b) rather than foo( a,b ).</p>
<p>Resistwriting lines of code that extend beyond 80 columns; instead,</p>
<p>folda long line when possible.  Occasionally a line cannot be easily</p>
<p>foldedand remain readable, so this should be taken as more of a</p>
<p>suggestionthan a fixed rule, but most lines can easily be made to fit</p>
<p>within80 columns.</p>
<p>Commentsshould never extend beyond 80 columns, especially sentence or</p>
<p>paragraphcomments that appear on a line or lines by themselves.</p>
<p>Theseshould generally be wordwrapped within 72 columns.  Any smart</p>
<p>editorcan do this easily.</p>
<p>CURLYBRACES:</p>
<p>Ingeneral, the opening curly brace for a block of text trails the</p>
<p>linethat introduces it, and the matching curly brace is on a line by</p>
<p>itself,lined up with the start of the introducing line, e.g.:</p>
<p>for(inti=0;i&lt;10;i++){</p>
<p>...</p>
<p>}</p>
<p>Commandslike if, while, and for should always use curly braces, even</p>
<p>ifthey only enclose one command.  That is, do this:</p>
<p>if(foo){</p>
<p>bar();</p>
<p>}</p>
<p>insteadof this:</p>
<p>if(foo)</p>
<p>bar();</p>
<p>NAMING:</p>
<p>Classnames are mixed case with an initial capital, e.g. MyNewClass.</p>
<p>Eachdifferent class (except nested classes, of course) is defined in</p>
<p>itsown header file named the same as the class itself, but with the</p>
<p>firstletter lowercase, e.g. myNewClass.h.</p>
<p>Typedefnames and other type names follow the same convention as class</p>
<p>names:mixed case with an initial capital.  These need not be defined</p>
<p>intheir own header file, but usually typedef names will be scoped</p>
<p>withinsome enclosing class.</p>
<p>Localvariable names are lowercase with an underscore delimiting</p>
<p>words:my_value.  Class data members, including static data members,</p>
<p>arethe same, but with a leading underscore: _my_data_member.  We do</p>
<p>notuse Hungarian notation.</p>
<p>Classmethod names, as well as standalone function names, are</p>
<p>lowercasewith a delimiting underscore, just like local variable</p>
<p>names:my_function().</p>
<p>LANGUAGECONSTRUCTS:</p>
<p>PreferC++ constructs over equivalent C constructs when writing C++</p>
<p>code. For instance, use:</p>
<p>staticconstintbuffer_size=1024;</p>
<p>insteadof:</p>
<p>#defineBUFFER_SIZE1024</p>
<p>Resistusing brand-new C++ features that are not broadly supported by</p>
<p>compilers. One of our goals in Panda is ease of distribution to a</p>
<p>widerange of platforms; this goal is thwarted if only a few compilers</p>
<p>maybe used.</p>
<p>Moreexamples of the agreed coding style may be found in</p>
<p>panda/src/doc/sampleClass.* fileshould be also in appendix of this manual.</p>
</div>
<div class="section" id="collisionflags">
<span id="collisionflags"></span><h2>COLLISIONFLAGS<a class="headerlink" href="#collisionflags" title="Permalink to this headline">¶</a></h2>
<p>floor:for things that avatars can stand on</p>
<p>barrier:for things that avatars should collide against that are not floors</p>
<p>camera-collide:for things that the camera should avoid</p>
<p>trigger:for things (usually not barriers or floors) that should trigger an</p>
<p>​        eventwhen avatars intersect with them</p>
<p>sphere:for things that should have a collision sphere around them</p>
<p>tube:for things that should have a collision tube (cylinder) around them</p>
<p>NOTES</p>
<p>Thebarrier &amp; camera-collide flags are typically used together.</p>
<p>Currently,the camera automatically pulls itself in front of anything</p>
<p>markedwith the camera-collide flag, so that the view of the avatar isn&#8217;t</p>
<p>blocked.</p>
<p>Thetrigger flag implies that avatars will not collide with the object;</p>
<p>theycan move freely through it.</p>
<p>Thesphere &amp; tube flags create a collision object that is as small as</p>
<p>possiblewhile completely containing the original flagged geometry.</p>
</div>
<div class="section" id="eggpalettize">
<span id="eggpalettize"></span><h2>eggpalettize<a class="headerlink" href="#eggpalettize" title="Permalink to this headline">¶</a></h2>
<div class="section" id="howto-use-egg-palettize">
<span id="howto-use-egg-palettize"></span><h3>HOWTO USE EGG_PALETTIZE<a class="headerlink" href="#howto-use-egg-palettize" title="Permalink to this headline">¶</a></h3>
<p>Theprogram egg-palettize is used when building models to optimize</p>
<p>textureusage on all models before loading them into the show.  It is</p>
<p>capableof collecting together several different small texture images</p>
<p>fromdifferent models and assembling them together onto the same image</p>
<p>file,potentially reducing the total number of different texture</p>
<p>imagesthat must be loaded and displayed at runtime from several</p>
<p>thousandto several hundred or fewer.</p>
<p>Italso can be used to group together related textures that will be</p>
<p>renderedat the same time (for instance, textures related to one</p>
<p>neighborhood),and if nothing else, it can resize textures at build</p>
<p>timeso that they may be painted at any arbitrary resolution according</p>
<p>tothe artist&#8217;s convenience, and then reduced to a suitable size for</p>
<p>texturememory management (and to meet hardware requirements of having</p>
<p>dimensionsthat are always a power of two).</p>
<p>Itis suggested that textures always be painted at high resolution and</p>
<p>reducedusing egg-palettize, since this allows the show designer the</p>
<p>greatestflexibility; if a decision is later made to increase the</p>
<p>resolutionof a texture, this may be done by changing an option with</p>
<p>egg-palettize,and does not require intervention of the artist.</p>
<p>Thebehavior of egg-palettize is largely controlled through a source</p>
<p>filecalled textures.txa, which is usually found in the src/maps</p>
<p>directorywithin the model tree.  For a complete description of the</p>
<p>syntaxof the textures.txa file, invoke the command egg-palettize -H.</p>
</div>
<div class="section" id="groupingegg-files">
<span id="groupingegg-files"></span><h3>GROUPINGEGG FILES<a class="headerlink" href="#groupingegg-files" title="Permalink to this headline">¶</a></h3>
<p>Muchof the contents of textures.txa involves assigning egg files to</p>
<p>variousgroups; assigning two egg files to the same group indicates</p>
<p>thatthey are associated in some way, and their texture images may be</p>
<p>copiedtogether into the same palettes.</p>
<p>Thegroups are arbitrary and should be defined at the beginning of the</p>
<p>eggfile with the syntax:</p>
<p>:groupgroupname</p>
<p>Wheregroupname is the name of the group.  It is also possible to</p>
<p>assigna directory name to a group.  This is optional, but if done, it</p>
<p>indicatesthat all of the textures for this group should be installed</p>
<p>withinthe named subdirectory.  The syntax is:</p>
<p>:groupgroupname dir dirname</p>
<p>Wheredirname is the name of the subdirectory.  If you are</p>
<p>generatinga phased download, the dirname should be one of phase_1,</p>
<p>phase_2,etc., corresponding to the PHASE variable in the install_egg</p>
<p>rule(see ppremake-models.txt).</p>
<p>Finally,it is possible to relate the different groups to each other</p>
<p>hierachically. Doing this allows egg-palettize to assign textures to</p>
<p>theminimal common subset between egg files that share the textures.</p>
<p>Forinstance, if group beta and group gamma both depend on group</p>
<p>alpha,a texture that is assigned to both groups beta and gamma can</p>
<p>actuallybe placed on group alpha, to maximize sharing and minimize</p>
<p>duplicationof palette space.</p>
<p>Yourelate two groups with the syntax:</p>
<p>:groupgroupname with basegroupname</p>
<p>Onceall the groups are defined, you can assign egg files to the</p>
<p>variousgroups with a syntax like this:</p>
<p>model.egg: groupname</p>
<p>wheremodel.egg is the name of some egg model file built within the</p>
<p>tree. You can explicitly group each egg file in this way, or you can</p>
<p>usewildcards to group several at once, e.g.:</p>
<p>dog*.egg: dogs</p>
<p>Assigningan egg file to a group assigns all of the textures used by</p>
<p>thategg file to that same group.  If no other egg files reference the</p>
<p>sametextures, those textures will be placed in one or more palette</p>
<p>imagesnamed after the group.  If another egg file in a different</p>
<p>groupalso references the textures, they will be assigned to the</p>
<p>lowestgroup that both groups have in common (see relating the groups</p>
<p>hierarchically,above), or copied into both palette images if the two</p>
<p>groupshaving nothing in common.</p>
</div>
<div class="section" id="controllingtexture-parameters">
<span id="controllingtexture-parameters"></span><h3>CONTROLLINGTEXTURE PARAMETERS<a class="headerlink" href="#controllingtexture-parameters" title="Permalink to this headline">¶</a></h3>
<p>Mostof the contents of the textures.txa is usually devoted to scaling</p>
<p>thetexture images appropriately.  This is usually done with a line</p>
<p>somethinglike this:</p>
<p>texture.rgb: 64 64</p>
<p>wheretexture.rgb is the name of some texture image, and 64 64 is the</p>
<p>sizein pixels it should be scaled to.  It is also possible to specify</p>
<p>thetarget size as a factor of the source size, e.g.:</p>
<p>bigtexture.rgb: 50%</p>
<p>specifiesthat the indicated texture should be scaled to 50% in each</p>
<p>dimension(for a total reduction to 0.5 * 0.5 = 25% of the original</p>
<p>area).</p>
<p>Asabove, you may group together multiple textures on the same line</p>
<p>usingwildcards, e.g.:</p>
<p>wall*.rgb: 25%</p>
<p>Finally,you may include one or more optional keywords on the end of</p>
<p>thetexture scaling line that indicate additional properties to apply</p>
<p>tothe named textures.  See egg-palettize -H for a complete list.</p>
<p>Someof the more common keywords are:</p>
<p>mipmap- Enables mipmaps for the texture.</p>
<p>linear- Disables mipmaps for the texture.</p>
<p>omit- Omits the texture from any palettes.  The texture will still</p>
<p>​    bescaled and installed, but it will not be combined with other</p>
<p>textures. Normally you need to do this only when the texture will</p>
<p>​    beapplied to some geometry at runtime.  (Since palettizing a</p>
<p>texturerequires adjusting the UV&#8217;s of all the geometry that</p>
<p>referencesit, a texture that is applied to geometry at runtime</p>
<p>cannotbe palettized.)</p>
</div>
<div class="section" id="runningegg-palettize">
<span id="runningegg-palettize"></span><h3>RUNNINGEGG-PALETTIZE<a class="headerlink" href="#runningegg-palettize" title="Permalink to this headline">¶</a></h3>
<p>Normally,egg-palettize is run automatically just by typing:</p>
<p>makeinstall</p>
<p>inthe model tree.  It automatically reads the textures.txa file and</p>
<p>generatesand installs the appropriate palette image files, as part of</p>
<p>thewhole build process, and requires no further intervention from the</p>
<p>user. See ppremake-models.txt for more information on setting up the</p>
<p>modeltree.</p>
<p>Whenegg-palettize runs in the normal mode, it generates suboptimal</p>
<p>palettes. Sometimes, for instance, a palette image is created with</p>
<p>onlyone small texture in the corner, and the rest of it unused.  This</p>
<p>happensbecause egg-palettize is reserving space for future textures,</p>
<p>andis ideal for development; but it is not suitable for shipping a</p>
<p>finishedproduct.  When you are ready to repack all of the palettes as</p>
<p>optimallyas possible, run the command:</p>
<p>makeopt-pal</p>
<p>Thiscauses egg-palettize to reorganize all of the palette images to</p>
<p>makethe best usage of texture memory.  It will force a regeneration</p>
<p>ofmost of the egg files in the model tree, so it can be a fairly</p>
<p>involvedoperation.</p>
<p>Itis sometimes useful to analyze the results of egg-palettize.  You</p>
<p>cantype:</p>
<p>makepi &gt;pi.txt</p>
<p>towrite a detailed report of every egg file, texture image, and</p>
<p>generatedpalette image to the file pi.txt.</p>
<p>Finally,the command:</p>
<p>makepal-stats &gt;stats.txt</p>
<p>willwrite a report to stats.txt of the estimated texture memory usage</p>
<p>forall textures, broken down by group.</p>
</div>
<div class="section" id="whenthings-go-wrong">
<span id="whenthings-go-wrong"></span><h3>WHENTHINGS GO WRONG<a class="headerlink" href="#whenthings-go-wrong" title="Permalink to this headline">¶</a></h3>
<p>Thewhole palettizing process is fairly complex; it&#8217;s necessary for</p>
<p>egg-palettizeto keep a record of the complete state of all egg files</p>
<p>andall textures ever built in a particular model tree.  It generally</p>
<p>doesa good job of figuring out when things change and correctly</p>
<p>regeneratingthe necessary egg files and textures when needed, but</p>
<p>sometimesit gets confused.</p>
<p>Thisis particularly likely to happen when you have reassigned some</p>
<p>eggfiles from one group to another, or redefined the relationship</p>
<p>betweendifferent groups.  Sometimes egg-palettize appears to run</p>
<p>correctly,but does not generate correct palettes.  Other times</p>
<p>egg-palettizewill fail with an assertion failure, or even a segment</p>
<p>fault(general protection fault) when running egg-palettize, due to</p>
<p>thiskind of confusion.  This behavior should not happen, but it does</p>
<p>happenevery once and a while.</p>
<p>Whenthis sort of thing happens, often the best thing to do is to</p>
<p>invokethe command:</p>
<p>makeundo-pal</p>
<p>followedby:</p>
<p>makeinstall</p>
<p>Thisremoves all of the old palettization information, including the</p>
<p>stateinformation cached from previous runs, and rebuilds a new set of</p>
<p>palettesfrom scratch.  It is a fairly heavy hammer, and may take some</p>
<p>timeto complete, depending on the size of your model tree, but it</p>
<p>almostalways clears up any problems related to egg-palettize.</p>
</div>
</div>
<div class="section" id="thephilosophy-of-egg-files">
<span id="thephilosophy-of-egg-files"></span><h2>THEPHILOSOPHY OF EGG FILES<a class="headerlink" href="#thephilosophy-of-egg-files" title="Permalink to this headline">¶</a></h2>
<p>THEPHILOSOPHY OF EGG FILES (vs. bam files)</p>
<p>Eggfiles are used by Panda3D to describe many properties of a scene:</p>
<p>simplegeometry, including special effects and collision surfaces,</p>
<p>charactersincluding skeletons, morphs, and multiple-joint</p>
<p>assignments,and character animation tables.</p>
<p>Eggfiles are designed to be the lingua franca of model manipulation</p>
<p>forPanda tools.  A number of utilities are provided that read and</p>
<p>writeegg files, for instance to convert to or from some other</p>
<p>modelingformat, or to apply a transform or optimize vertices.  The</p>
<p>eggfile philosophy is to describe objects in an abstract way that</p>
<p>facilitateseasy manipulation; thus, the format doesn&#8217;t (usually)</p>
<p>includeinformation such as polygon connectivity or triangle meshes.</p>
<p>Eggfiles are furthermore designed to be human-readable to help a</p>
<p>developerdiagnose (and sometimes repair) problems.  Also, the egg</p>
<p>syntaxis always intended to be backward compatible with previous</p>
<p>versions,so that as the egg syntax is extended, old egg files will</p>
<p>continueto remain valid.</p>
<p>Thisis a different philosophy than Panda&#8217;s bam file format, which is</p>
<p>abinary representation of a model and/or animation that is designed</p>
<p>tobe loaded quickly and efficiently, and is strictly tied to a</p>
<p>particularversion of Panda.  The data in a bam file closely mirrors</p>
<p>theactual Panda structures that are used for rendering.  Although an</p>
<p>effortis made to keep bam files backward compatible, occasionally</p>
<p>thisis not possible and we must introduce a new bam file major</p>
<p>version.</p>
<p>Whereegg files are used for model conversion and manipulation of</p>
<p>models,bam files are strictly used for loading models into Panda.</p>
<p>Althoughyou can load an egg file directly, a bam file will be loaded</p>
<p>muchmore quickly.</p>
<p>Eggfiles might be generated by outside sources, and thus it makes</p>
<p>senseto document its syntax here.  Bam files, on the other hand,</p>
<p>shouldonly be generated by Panda3D, usually by the program egg2bam.</p>
<p>Theexact specification of the bam file format, if you should need it,</p>
<p>isdocumented within the Panda3D code itself.</p>
<div class="section" id="generalegg-syntax">
<span id="generalegg-syntax"></span><h3>GENERALEGG SYNTAX<a class="headerlink" href="#generalegg-syntax" title="Permalink to this headline">¶</a></h3>
<p>Eggfiles consist of a series of sequential and hierarchically-nested</p>
<p>entries. In general, the syntax of each entry is:</p>
<p>&lt;Entry-type&gt;name{contents}</p>
<p>Wherethe name is optional (and in many cases, ignored anyway) and the</p>
<p>syntaxof the contents is determined by the entry-type.  The name (and</p>
<p>stringsin general) may be either quoted with double quotes or</p>
<p>unquoted. Newlines are treated like any other whitespace, and case is</p>
<p>notsignificant.  The angle brackets are literally a part of the entry</p>
<p>keyword. (Square brackets and ellipses in this document are used to</p>
<p>indicateoptional pieces, and are not literally part of the syntax.)</p>
<p>Thename field is always syntactically allowed between an entry</p>
<p>keywordand its opening brace, even if it will be ignored.  In the</p>
<p>syntaxlines given below, the name is not shown if it will be ignored.</p>
<p>Commentsmay be delimited using either the C++-style // ... or the</p>
<p>C-style/* ... */.  C comments do not nest.  There is also a <Comment></p>
<p>entrytype, of the form:</p>
<p><Comment>{text}</p>
<p><Comment>entries are slightly different, in that tools which read and</p>
<p>writeegg files will preserve the text within <Comment> entries, but</p>
<p>theymay not preserve comments delimited by // or /* */.  Special</p>
<p>charactersand keywords within a <Comment> entry should be quoted;</p>
<p>it&#8217;ssafest to quote the entire comment.</p>
</div>
<div class="section" id="localinformation-entries">
<span id="localinformation-entries"></span><h3>LOCALINFORMATION ENTRIES<a class="headerlink" href="#localinformation-entries" title="Permalink to this headline">¶</a></h3>
<p>Thesenodes contain information relevant to the current level of</p>
<p>nestingonly.</p>
<p><Scalar>name{value}</p>
<p>&lt;Char*&gt;name{value}</p>
<p>Scalarscan appear in various contexts.  They are always optional,</p>
<p>andspecify some attribute value relevant to the current context.</p>
<p>Thescalar name is the name of the attribute; different attribute</p>
<p>namesare meaningful in different contexts.  The value is either a</p>
<p>numericor a (quoted or unquoted) string value; the interpretation</p>
<p>asa number or as a string depends on the nature of the named</p>
<p>attribute. Because of a syntactic accident with the way the egg</p>
<p>syntaxevolved, <Scalar> and &lt;Char*&gt; are lexically the same andboth</p>
<p>canrepresent either a string or a number.  &lt;Char*&gt; is being phased</p>
<p>out;it is suggested that new egg files use only <Scalar>.</p>
</div>
<div class="section" id="globalinformation-entries">
<span id="globalinformation-entries"></span><h3>GLOBALINFORMATION ENTRIES<a class="headerlink" href="#globalinformation-entries" title="Permalink to this headline">¶</a></h3>
<p>Thesenodes contain information relevant to the file as a whole.  They</p>
<p>canbe nested along with geometry nodes, but this nesting is</p>
<p>irrelevantand the only significant placement rule is that they should</p>
<p>appearbefore they are referenced.</p>
<p><CoordinateSystem>{string}</p>
<p>Thisentry indicates the coordinate system used in the egg file; the</p>
<p>eggloader will automatically make a conversion if necessary.  The</p>
<p>followingstrings are valid: Y-up, Z-up, Y-up-right, Z-up-right,</p>
<p>Y-up-left,or Z-up-left.  (Y-up is the same as Y-up-right, and Z-up</p>
<p>isthe same as Z-up-right.)</p>
<p>Byconvention, this entry should only appear at the beginning of the</p>
<p>file,although it is technically allowed anywhere.  It is an error</p>
<p>toinclude more than one coordinate system entry in the same file.</p>
<p>Ifit is omitted, Y-up is assumed.</p>
<p><Texture>name{filename[scalars]}</p>
<p>Thisdescribes a texture file that can be referenced later with</p>
<p><TRef>{ name }.  It is not necessary to make a <Texture> entry for</p>
<p>eachtexture to be used; a texture may also be referenced directly</p>
<p>bythe geometry via an abbreviated inline <Texture> entry, but a</p>
<p>separate<Texture> entry is the only way to specify anything other</p>
<p>thanthe default texture attributes.</p>
<p>Ifthe filename is a relative path, the current egg file&#8217;s directory</p>
<p>issearched first, and then the texture-path and model-path are</p>
<p>searched.</p>
<p>Thefollowing attributes are presently implemented for textures:</p>
<p><Scalar>alpha-file{alpha-filename}</p>
<p>​    Ifthis scalar is present, the texture file&#8217;s alpha channel is</p>
<p>readin from the named image file (which should contain a</p>
<p>grayscaleimage), and the two images are combined into a single</p>
<p>two-or four-channel image internally.  This is useful for loading</p>
<p>alphachannels along with image file formats like JPEG that don&#8217;t</p>
<p>traditionallysupport alpha channels.</p>
<p><Scalar>alpha-file-channel{channel}</p>
<p>Thisdefines the channel that should be extracted from the file</p>
<p>namedby alpha-file to determine the alpha channel for the</p>
<p>resultingchannel.  The default is 0, which means the grayscale</p>
<p>combinationof r, g, b.  Otherwise, this should be the 1-based</p>
<p>channelnumber, for instance 1, 2, or 3 for r, g, or b,</p>
<p>respectively,or 4 for the alpha channel of a four-component</p>
<p>image.</p>
<p><Scalar>format{format-definition}</p>
<p>Thisdefines the load format of the image file.  The</p>
<p>format-definitionis one of:</p>
<p>​     RGBA,RGBM, RGBA12, RGBA8, RGBA4,</p>
<p>​     RGB,RGB12, RGB8, RGB5, RGB332,</p>
<p>​     LUMINANCE_ALPHA,</p>
<p>​     RED,GREEN, BLUE, ALPHA, LUMINANCE</p>
<p>Theformats whose names end in digits specifically request a</p>
<p>particulartexel width.  RGB12 and RGBA12 specify 48-bit texels</p>
<p>withor without alpha; RGB8 and RGBA8 specify 32-bit texels, and</p>
<p>RGB5and RGBA4 specify 16-bit texels.  RGB332 specifies 8-bit</p>
<p>texels.</p>
<p>Theremaining formats are generic and specify only the semantic</p>
<p>meaningof the channels.  The size of the texels is determined by</p>
<p>thewidth of the components in the image file.  RGBA is the most</p>
<p>general;RGB is the same, but without any alpha channel.  RGBM is</p>
<p>likeRGBA, except that it requests only one bit of alpha, if the</p>
<p>graphicscard can provide that, to leave more room for the RGB</p>
<p>components,which is especially important for older 16-bit</p>
<p>graphicscards (the &#8220;M&#8221; stands for &#8220;mask&#8221;, as in acutout).</p>
<p>Thenumber of components of the image file should match the format</p>
<p>specified;if it does not, the egg loader will attempt to provide</p>
<p>theclosest match that does.</p>
<p><Scalar>compression{compression-mode}</p>
<p>Definesan explicit control over the real-time compression mode</p>
<p>appliedto the texture.  The various options are:</p>
<p>​     DEFAULTOFF ON</p>
<p>​     FXT1DXT1 DXT2 DXT3 DXT4 DXT5</p>
<p>Thiscontrols the compression of the texture when it is loaded</p>
<p>intographics memory, and has nothing to do with on-disk</p>
<p>compressionsuch as JPEG.  If this option is omitted or &#8220;DEFAULT&#8221;,</p>
<p>thenthe texture compression is controlled by the</p>
<p>compressed-texturesconfig variable.  If it is &#8220;OFF&#8221;, texture</p>
<p>compressionis explicitly off for this texture regardless of the</p>
<p>settingof the config variable; if it is &#8220;ON&#8221;, texture compression</p>
<p>​    isexplicitly on, and a default compression algorithm supported by</p>
<p>thedriver is selected.  If any of the other options, it names the</p>
<p>specificcompression algorithm to be used.</p>
<p><Scalar>wrap{repeat-definition}</p>
<p><Scalar>wrapu{repeat-definition}</p>
<p><Scalar>wrapv{repeat-definition}</p>
<p><Scalar>wrapw{repeat-definition}</p>
<p>Thisdefines the behavior of the texture image outside of the</p>
<p>normal(u,v) range 0.0 - 1.0.  It is &#8220;REPEAT&#8221; to repeat the</p>
<p>textureto infinity, &#8220;CLAMP&#8221; not to.  The wrapping behavior may be</p>
<p>specifiedindependently for each axis via &#8220;wrapu&#8221; and &#8220;wrapv&#8221;,or</p>
<p>​    itmay be specified for both simultaneously via &#8220;wrap&#8221;.</p>
<p>Althoughless often used, for 3-d textures wrapw may also be</p>
<p>specified,and it behaves similarly to wrapu and wrapv.</p>
<p>Thereare other legal values in addtional to REPEAT and CLAMP.</p>
<p>Thefull list is:</p>
<p>​     CLAMP</p>
<p>​     REPEAT</p>
<p>​     MIRROR</p>
<p>​     MIRROR_ONCE</p>
<p>​     BORDER_COLOR</p>
<p><Scalar>borderr{red-value}</p>
<p><Scalar>borderg{green-value}</p>
<p><Scalar>borderb{blue-value}</p>
<p><Scalar>bordera{alpha-value}</p>
<p>Thesedefine the &#8220;border color&#8221; of the texture, which is</p>
<p>particularlyimportant when one of the wrap modes, above, is</p>
<p>BORDER_COLOR.</p>
<p><Scalar>type{texture-type}</p>
<p>Thismay be one of the following attributes:</p>
<p>​     1D</p>
<p>​     2D</p>
<p>​     3D</p>
<p>​     CUBE_MAP</p>
<p>Thedefault is &#8220;2D&#8221;, which specifies a normal, 2-d texture.  If</p>
<p>anyof the other types is specified instead, a texture image of</p>
<p>thecorresponding type is loaded.</p>
<p>​    If3D or CUBE_MAP is specified, then a series of texture images</p>
<p>mustbe loaded to make up the complete texture; in this case, the</p>
<p>texturefilename is expected to include a sequence of one or more</p>
<p>hashmark (&#8220;#&#8221;) characters, which will be filled in with the</p>
<p>sequencenumber.  The first image in the sequence must be numbered</p>
<p>​    0,and there must be no gaps in the sequence.  In this case, a</p>
<p>separatealpha-file designation is ignored; the alpha channel, if</p>
<p>present,must be included in the same image with the color</p>
<p>channel(s).</p>
<p><Scalar>multiview { flag }</p>
<p>​    Ifthis flag is nonzero, the texture is loaded as a multiview</p>
<p>texture. In this case, the filename must contain a hash mark</p>
<p>(&#8220;#&#8221;)as in the 3D or CUBE_MAP case, above, and the different</p>
<p>imagesare loaded into the different views of the multiview</p>
<p>textures. If the texture is already a cube map texture, the</p>
<p>samehash sequence is used for both purposes: the first six images</p>
<p>definethe first view, the next six images define the second view,</p>
<p>andso on.  If the texture is a 3-D texture, you must also specify</p>
<p>num-views,below, to tell the loader how many images are loaded</p>
<p>forviews, and how many are loaded for levels.</p>
<p>​    Amultiview texture is most often used to load stereo textures,</p>
<p>wherea different image is presented to each eye viewing the</p>
<p>texture,but other uses are possible, such as for texture</p>
<p>animation.</p>
<p><Scalar>num-views { count }</p>
<p>Thisis used only when loading a 3-D multiview texture.  It</p>
<p>specifieshow many different views the texture holds; the z height</p>
<p>​    ofthe texture is then implicitly determined as (number of images)</p>
<p>​    /(number of views).</p>
<p><Scalar>read-mipmaps { flag }</p>
<p>Ifthis flag is nonzero, then pre-generated mipmap levels will be</p>
<p>loadedalong with the texture.  In this case, the filename should</p>
<p>containa sequence of one or more hash mark (&#8220;#&#8221;) characters,</p>
<p>whichwill be filled in with the mipmap level number; the texture</p>
<p>filenamethus determines a series of images, one for each mipmap</p>
<p>level. The base texture image is mipmap level 0.</p>
<p>​    Ifthis flag is specified in conjunction with a 3D or cube map</p>
<p>texture(as specified above), then the filename should contain two</p>
<p>hashmark sequences, separated by a character such as an</p>
<p>underscore,hyphen, or dot.  The first sequence will be filled in</p>
<p>withthe mipmap level index, and the second sequence will be</p>
<p>filledin with the 3D sequence or cube map face.</p>
<p><Scalar>minfilter { filter-type }</p>
<p><Scalar>magfilter { filter-type }</p>
<p><Scalar>magfilteralpha { filter-type }</p>
<p><Scalar>magfiltercolor { filter-type }</p>
<p>Thisspecifies the type of filter applied when minimizing or</p>
<p>maximizing. Filter-type may be one of:</p>
<p>​     NEAREST</p>
<p>​     LINEAR</p>
<p>​     NEAREST_MIPMAP_NEAREST</p>
<p>​     LINEAR_MIPMAP_NEAREST</p>
<p>​     NEAREST_MIPMAP_LINEAR</p>
<p>​     LINEAR_MIPMAP_LINEAR</p>
<p>Thereare also some additional filter types that are supported for</p>
<p>historicalreasons, but each of those additional types maps to one</p>
<p>​    ofthe above.  New egg files should use only the above filter</p>
<p>types.</p>
<p><Scalar>anisotropic-degree { degree }</p>
<p>Enablesanisotropic filtering for the texture, and specifies the</p>
<p>degreeof filtering.  If the degree is 0 or 1, anisotropic</p>
<p>filteringis disabled.  The default is disabled.</p>
<p><Scalar>envtype { environment-type }</p>
<p>Thisspecifies the type of texture environment to create; i.e. it</p>
<p>controlsthe way in which textures apply to models.</p>
<p>Environment-typemay be one of:</p>
<p>​     MODULATE</p>
<p>​     DECAL</p>
<p>​     BLEND</p>
<p>​     REPLACE</p>
<p>​     ADD</p>
<p>​     BLEND_COLOR_SCALE</p>
<p>​     MODULATE_GLOW</p>
<p>​     MODULATE_GLOSS</p>
<p>​    *NORMAL</p>
<p>​    *NORMAL_HEIGHT</p>
<p>​    *GLOW</p>
<p>​    *GLOSS</p>
<p>​    *HEIGHT</p>
<p>​    *SELECTOR</p>
<p>Thedefault environment type is MODULATE, which means the texture</p>
<p>coloris multiplied with the base polygon (or vertex) color.  This</p>
<p>​    isthe most common texture environment by far.  Other environment</p>
<p>typesare more esoteric and are especially useful in the presence</p>
<p>​    ofmultitexture.  In particular, the types prefixed by an asterisk</p>
<p>(*)require enabling Panda&#8217;s automatic ShaderGenerator.</p>
<p><Scalar>combine-rgb{combine-mode}</p>
<p><Scalar>combine-alpha{combine-mode}</p>
<p><Scalar>combine-rgb-source0{combine-source}</p>
<p><Scalar>combine-rgb-operand0{combine-operand}</p>
<p><Scalar>combine-rgb-source1{combine-source}</p>
<p><Scalar>combine-rgb-operand1{combine-operand}</p>
<p><Scalar>combine-rgb-source2{combine-source}</p>
<p><Scalar>combine-rgb-operand2{combine-operand}</p>
<p><Scalar>combine-alpha-source0{combine-source}</p>
<p><Scalar>combine-alpha-operand0{combine-operand}</p>
<p><Scalar>combine-alpha-source1{combine-source}</p>
<p><Scalar>combine-alpha-operand1{combine-operand}</p>
<p><Scalar>combine-alpha-source2{combine-source}</p>
<p><Scalar>combine-alpha-operand2{combine-operand}</p>
<p>Theseoptions replace the envtype and specify the texture combiner</p>
<p>mode,which is usually used for multitexturing.  This specifies</p>
<p>howthe texture combines with the base color and/or the other</p>
<p>texturesapplied previously.  You must specify both an rgb and an</p>
<p>alphacombine mode.  Some combine-modes use one source/operand</p>
<p>pair,and some use all three; most use just two.</p>
<p>combine-modemay be one of:</p>
<p>​     REPLACE</p>
<p>​     MODULATE</p>
<p>​     ADD</p>
<p>​     ADD-SIGNED</p>
<p>​     INTERPOLATE</p>
<p>​     SUBTRACT</p>
<p>​     DOT3-RGB</p>
<p>​     DOT3-RGBA</p>
<p>combine-sourcemay be one of:</p>
<p>​     TEXTURE</p>
<p>​     CONSTANT</p>
<p>​     PRIMARY-COLOR</p>
<p>​     PREVIOUS</p>
<p>​     CONSTANT_COLOR_SCALE</p>
<p>​     LAST_SAVED_RESULT</p>
<p>combine-operandmay be one of:</p>
<p>​     SRC-COLOR</p>
<p>​     ONE-MINUS-SRC-COLOR</p>
<p>​     SRC-ALPHA</p>
<p>​     ONE-MINUS-SRC-ALPHA</p>
<p>Thedefault values if any of these are omitted are:</p>
<p>​     <Scalar>combine-rgb{modulate}</p>
<p>​     <Scalar>combine-alpha{modulate}</p>
<p>​     <Scalar>combine-rgb-source0{previous}</p>
<p>​     <Scalar>combine-rgb-operand0{src-color}</p>
<p>​     <Scalar>combine-rgb-source1{texture}</p>
<p>​     <Scalar>combine-rgb-operand1{src-color}</p>
<p>​     <Scalar>combine-rgb-source2{constant}</p>
<p>​     <Scalar>combine-rgb-operand2{src-alpha}</p>
<p>​     <Scalar>combine-alpha-source0{previous}</p>
<p>​     <Scalar>combine-alpha-operand0{src-alpha}</p>
<p>​     <Scalar>combine-alpha-source1{texture}</p>
<p>​     <Scalar>combine-alpha-operand1{src-alpha}</p>
<p>​     <Scalar>combine-alpha-source2{constant}</p>
<p>​     <Scalar>combine-alpha-operand2{src-alpha}</p>
<p><Scalar>saved-result{flag}</p>
<p>​    Ifflag is nonzero, then it indicates that this particular texture</p>
<p>stagewill be supplied as the &#8220;last_saved_result&#8221; source for any</p>
<p>futuretexture stages.</p>
<p><Scalar>tex-gen{mode}</p>
<p>Thisspecifies that texture coordinates for the primitives that</p>
<p>referencethis texture should be dynamically computed at runtime,</p>
<p>forinstance to apply a reflection map or some other effect.  The</p>
<p>validvalues for mode are:</p>
<p>​     EYE_SPHERE_MAP(or SPHERE_MAP)</p>
<p>​     WORLD_CUBE_MAP</p>
<p>​     EYE_CUBE_MAP(or CUBE_MAP)</p>
<p>​     WORLD_NORMAL</p>
<p>​     EYE_NORMAL</p>
<p>​     WORLD_POSITION</p>
<p>​     EYE_POSITION</p>
<p>​     POINT_SPRITE</p>
<p><Scalar>stage-name { name }</p>
<p>Specifiesthe name of the TextureStage object that is created to</p>
<p>renderthis texture.  If this is omitted, a custom TextureStage is</p>
<p>createdfor this texture if it is required (e.g. because some</p>
<p>othermultitexturing parameter has been specified), or the system</p>
<p>defaultTextureStage is used if multitexturing is not required.</p>
<p><Scalar>priority { priority-value }</p>
<p>Specifiesan integer sort value to rank this texture in priority</p>
<p>amongother textures that are applied to the same geometry.  This</p>
<p>​    isonly used to eliminate low-priority textures in case more</p>
<p>texturesare requested for a particular piece of geometry than the</p>
<p>graphicshardware can render.</p>
<p><Scalar>blendr { red-value }</p>
<p><Scalar>blendg { green-value }</p>
<p><Scalar>blendb { blue-value }</p>
<p><Scalar>blenda { alpha-value }</p>
<p>Specifiesa four-component color that is applied with the color in</p>
<p>casethe envtype, above, is &#8220;blend&#8221;, or one of thecombine-sources</p>
<p>​    is&#8221;constant&#8221;.</p>
<p><Scalar>uv-name { name }</p>
<p>Specifiesthe name of the texture coordinates that are to be</p>
<p>associatedwith this texture.  If this is omitted, the default</p>
<p>texturecoordinates are used.</p>
<p><Scalar>rgb-scale { scale }</p>
<p><Scalar>alpha-scale { scale }</p>
<p>Specifiesan additional scale factor that will scale the r, g, b</p>
<p>(ora) components after the texture has been applied.  This is</p>
<p>onlyused when a combine mode is in effect.  The only legal values</p>
<p>are1, 2, or 4.</p>
<p><Scalar>alpha { alpha-type }</p>
<p>Thisspecifies whether and what type of transparency will be</p>
<p>performed. Alpha-type may be one of:</p>
<p>​     OFF</p>
<p>​     ON</p>
<p>​     BLEND</p>
<p>​     BLEND_NO_OCCLUDE</p>
<p>​     MS</p>
<p>​     MS_MASK</p>
<p>​     BINARY</p>
<p>​     DUAL</p>
<p>​    Ifalpha-type is OFF, it means not to enable transparency, even if</p>
<p>theimage contains an alpha channel or the format is RGBA.  If</p>
<p>alpha-typeis ON, it means to enable the default transparency,</p>
<p>evenif the image filename does not contain an alpha channel.  If</p>
<p>alpha-typeis any of the other options, it specifies the type of</p>
<p>transparencyto be enabled.</p>
<p><Scalar>bin { bin-name }</p>
<p>Thisspecifies the bin name order of all polygons with this</p>
<p>textureapplied, in the absence of a bin name specified on the</p>
<p>polygonitself.  See the description for bin under polygon</p>
<p>attributes.</p>
<p><Scalar>draw-order { number }</p>
<p>Thisspecifies the fixed drawing order of all polygons with this</p>
<p>textureapplied, in the absence of a drawing order specified on</p>
<p>thepolygon itself.  See the description for draw-order under</p>
<p>polygonattributes.</p>
<p><Scalar>depth-offset { number }</p>
<p><Scalar>depth-write { mode }</p>
<p><Scalar>depth-test { mode }</p>
<p>Specifiesspecial depth buffer properties of all polygons with this</p>
<p>textureapplied.  See the descriptions for the individual</p>
<p>attributesunder polygon attributes.</p>
<p><Scalar>quality-level { quality }</p>
<p>Setsa hint to the renderer about the desired performance /</p>
<p>qualitytradeoff for this particular texture.  This is most useful</p>
<p>forthe tinydisplay software renderer; for normal,</p>
<p>hardware-acceleratedrenderers, this may have little or no effect.</p>
<p>Thismay be one of:</p>
<p>​     DEFAULT</p>
<p>​     FASTEST</p>
<p>​     NORMAL</p>
<p>​     BEST</p>
<p>&#8220;Default&#8221;means to use whatever quality level is specified by the</p>
<p>globaltexture-quality-level config variable.</p>
<p><Transform>{ transform-definition }</p>
<p>Thisspecifies a 2-d or 3-d transformation that is applied to the</p>
<p>UV&#8217;sof a surface to generate the texture coordinates.</p>
<p>Thetransform syntax is similar to that for groups, except it may</p>
<p>defineeither a 2-d 3x3 matrix or a 3-d 4x4 matrix.  (You should</p>
<p>usethe two-dimensional forms if the UV&#8217;s are two-dimensional, and</p>
<p>thethree-dimensional forms if the UV&#8217;s are three-dimensional.)</p>
<p>​    Atwo-dimensional transform may be any sequence of zero or more of</p>
<p>thefollowing.  Transformations are post multiplied in the order</p>
<p>theyare encountered to produce a net transformation matrix.</p>
<p>Rotationsare counterclockwise about the origin in degrees.</p>
<p>Matrices,when specified explicitly, are row-major.</p>
<p>​     <Translate>{ x y }</p>
<p>​     <Rotate>{ degrees }</p>
<p>​     <Scale>{ x y }</p>
<p>​     <Scale>{ s }</p>
<p>​     <Matrix3>{</p>
<p>​       0001 02</p>
<p>​       1011 12</p>
<p>​       2021 22</p>
<p>​     }</p>
<p>​    Athree-dimensional transform may be any sequence of zero or more</p>
<p>​    ofthe following.  See the description under <Group>, below, for</p>
<p>moreinformation.</p>
<p>​     <Translate>{ x y z }</p>
<p>​     <RotX>{ degrees }</p>
<p>​     <RotY>{ degrees }</p>
<p>​     <RotZ>{ degrees }</p>
<p>​     <Rotate>{ degrees x y z }</p>
<p>​     <Scale>{ x y z }</p>
<p>​     <Scale>{ s }</p>
<p>​     <Matrix4>{</p>
<p>​       0001 02 03</p>
<p>​       1011 12 13</p>
<p>​       2021 22 23</p>
<p>​       3031 32 33</p>
<p>​     }</p>
<p><Material>name { [scalars] }</p>
<p>Thisdefines a set of material attributes that may later be</p>
<p>referencedwith <MRef> { name }.</p>
<p>Thefollowing attributes may appear within the material block:</p>
<p><Scalar>diffr { number }</p>
<p><Scalar>diffg { number }</p>
<p><Scalar>diffb { number }</p>
<p><Scalar>diffa { number }</p>
<p><Scalar>ambr { number }</p>
<p><Scalar>ambg { number }</p>
<p><Scalar>ambb { number }</p>
<p><Scalar>amba { number }</p>
<p><Scalar>emitr { number }</p>
<p><Scalar>emitg { number }</p>
<p><Scalar>emitb { number }</p>
<p><Scalar>emita { number }</p>
<p><Scalar>specr { number }</p>
<p><Scalar>specg { number }</p>
<p><Scalar>specb { number }</p>
<p><Scalar>speca { number }</p>
<p><Scalar>shininess { number }</p>
<p><Scalar>local { flag }</p>
<p>Theseproperties collectively define a &#8220;material&#8221; that controlsthe</p>
<p>lightingeffects that are applied to a surface; a material is only</p>
<p>ineffect in the presence of lighting.</p>
<p>Thefour color groups, diff<em>, amb</em>, emit<em>, and spec</em> specify the</p>
<p>diffuse,ambient, emission, and specular components of the lighting</p>
<p>equation,respectively.  Any of them may be omitted; the omitted</p>
<p>component(s)take their color from the native color of the</p>
<p>primitive,otherwise the primitive color is replaced with the</p>
<p>materialcolor.</p>
<p>Theshininess property controls the size of the specular highlight,</p>
<p>andthe value ranges from 0 to 128.  A larger value creates a</p>
<p>smallerhighlight (creating the appearance of a shinier surface).</p>
<p><VertexPool>name { vertices }</p>
<p>Avertex pool is a set of vertices.  All geometry is created by</p>
<p>referringto vertices by number in a particular vertex pool.  There</p>
<p>maybe one or several vertex pools in an egg file, but all vertices</p>
<p>thatmake up a single polygon must come from the same vertex pool.</p>
<p>Thebody of a <VertexPool> entry is simply a list of one or more</p>
<p><Vertex>entries, as follows:</p>
<p><Vertex>number { x [y [z [w]]] [attributes] }</p>
<p>​    A<Vertex> entry is only valid within a vertex pool definition.</p>
<p>Thenumber is the index by which this vertex will be referenced.</p>
<p>​    Itis optional; if it is omitted, the vertices are implicitly</p>
<p>numberedconsecutively beginning at one.  If the number is</p>
<p>supplied,the vertices need not be consecutive.</p>
<p>Normally,vertices are three-dimensional (with coordinates x, y,</p>
<p>andz); however, in certain cases vertices may have fewer or more</p>
<p>dimensions,up to four.  This is particularly true of vertices</p>
<p>usedas control vertices of NURBS curves and surfaces.  If more</p>
<p>coordinatesare supplied than needed, the extra coordinates are</p>
<p>ignored;if fewer are supplied than needed, the missing</p>
<p>coordinatesare assumed to be 0.</p>
<p>Thevertex&#8217;s coordinates are always given in world space,</p>
<p>regardlessof any transforms before the vertex pool or before the</p>
<p>referencinggeometry.  If the vertex is referenced by geometry</p>
<p>undera transform, the egg loader will do an inverse transform to</p>
<p>movethe vertex into the proper coordinate space without changing</p>
<p>itsposition in world space.  One exception is geometry under an</p>
<p><Instance>node; in this case the vertex coordinates are given in</p>
<p>thespace of the <Instance> node.  (Another exception is a</p>
<p><DynamicVertexPool>;see below.)</p>
<p>​    Inneither case does it make a difference whether the vertex pool</p>
<p>​    isitself declared under a transform or an <Instance> node.  The</p>
<p>onlydeciding factor is whether the geometry that <em>uses</em> the</p>
<p>vertexpool appears under an <Instance> node.  It is possible for</p>
<p>​    asingle vertex to be interpreted in different coordinate spaces</p>
<p>​    bydifferent polygons.</p>
<p>Whileeach vertex must at least have a position, it may also have</p>
<p>​    acolor, normal, pair of UV coordinates, and/or a set of morph</p>
<p>offsets. Furthermore, the color, normal, and UV coordinates may</p>
<p>themselveshave morph offsets.  Thus, the [attributes] in the</p>
<p>syntaxline above may be replaced with zero or more of the</p>
<p>followingentries:</p>
<p><Dxyz>target { x y z }</p>
<p>Thisspecifies the offset of this vertex for the named morph</p>
<p>target. See the &#8220;MORPH DESCRIPTION ENTRIES&#8221; header, below.</p>
<p><Normal>{ x y z [morph-list] }</p>
<p>Thisspecifies the surface normal of the vertex.  If omitted, the</p>
<p>vertexwill have no normal.  Normals may also be morphed;</p>
<p>morph-listhere is thus an optional list of <DNormal> entries,</p>
<p>similarto the above.</p>
<p><RGBA>{ r g b a [morph-list] }</p>
<p>Thisspecifies the four-valued color of the vertex.  Each</p>
<p>componentis in the range 0.0 to 1.0.  A vertex color, if</p>
<p>specifiedfor all vertices of the polygon, overrides the polygon&#8217;s</p>
<p>color. If neither color is given, the default is white</p>
<p>​    (11 1 1).  The morph-list is an optional list of <DRGBA> entries.</p>
<p><UV>[name] { u v [w] [tangent] [binormal] [morph-list] }</p>
<p>Thisgives the texture coordinates of the vertex.  This must be</p>
<p>specifiedif a texture is to be mapped onto this geometry.</p>
<p>Thetexture coordinates are usually two-dimensional, with two</p>
<p>componentvalues (u v), but they may also be three-dimensional,</p>
<p>withthree component values (u v w).  (Arguably, it should be</p>
<p>called<UVW> instead of <UV> in the three-dimensional case, but</p>
<p>it&#8217;snot.)</p>
<p>​    Asbefore, morph-list is an optional list of <DUV> entries.</p>
<p>Unlikethe other kinds of attributes, there may be multiple sets</p>
<p>​    ofUV&#8217;s on each vertex, each with a unique name; this provides</p>
<p>supportfor multitexturing.  The name may be omitted to specify</p>
<p>thedefault UV&#8217;s.</p>
<p>TheUV&#8217;s also support an optional tangent and binormal.  These</p>
<p>valuesare based on the vertex normal and the UV coordinates of</p>
<p>connectedvertices, and are used to render normal maps and similar</p>
<p>lightingeffects.  They are defined within the <UV> entry because</p>
<p>theremay be a different set of tangents and binormals for each</p>
<p>differentUV coordinate set.  If present, they have the expected</p>
<p>syntax:</p>
<p><UV>[name] { u v [w] <Tangent> { x y z } <Binormal> { x y z }}</p>
<p><AUX>name { x y z w }</p>
<p>Thisspecifies some named per-vertex auxiliary data which is</p>
<p>importedfrom the egg file without further interpretation by</p>
<p>Panda. The auxiliary data is copied to the vertex data under a</p>
<p>columnwith the specified name.  Presumably the data will have</p>
<p>meaningto custom code or a custom shader.  Like named UV&#8217;s, there</p>
<p>maybe multiple Aux entries for a given vertex, each with a</p>
<p>differentname.</p>
<p>​</p>
<p><DynamicVertexPool>name { vertices }</p>
<p>Adynamic vertex pool is similar to a vertex pool in most respects,</p>
<p>exceptthat each vertex might be animated by substituting in values</p>
<p>froma <VertexAnim> table.  Also, the vertices defined within a</p>
<p>dynamicvertex pool are always given in local coordinates, instead</p>
<p>ofworld coordinates.</p>
<p>Thepresence of a dynamic vertex pool makes sense only within a</p>
<p>charactermodel, and a single dynamic vertex pool may not span</p>
<p>multiplecharacters.  Each dynamic vertex pool creates a DynVerts</p>
<p>objectwithin the character by the same name; this name is used</p>
<p>laterwhen matching up the corresponding <VertexAnim>.</p>
<p>Atthe present time, the DynamicVertexPool is not implemented in</p>
<p>Panda3D.</p>
</div>
<div class="section" id="geometryentries">
<span id="geometryentries"></span><h3>GEOMETRYENTRIES<a class="headerlink" href="#geometryentries" title="Permalink to this headline">¶</a></h3>
<p><Polygon>name {</p>
<p>[attributes]</p>
<p><VertexRef>{</p>
<p>​       indices</p>
<p>​       <Ref>{ pool-name }</p>
<p>​    }</p>
<p>}</p>
<p>Apolygon consists of a sequence of vertices from a single vertex</p>
<p>pool. Vertices are identified by pool-name and index number within</p>
<p>thepool; indices is a list of vertex numbers within the given</p>
<p>vertexpool.  Vertices are listed in counterclockwise order.</p>
<p>Althoughthe vertices must all come from the same vertex pool, they</p>
<p>mayhave been assigned to arbitrarily many different joints</p>
<p>regardlessof joint connectivity (there is no &#8220;straddle-polygon&#8221;</p>
<p>limitation). See Joints, below.</p>
<p>Thepolygon syntax is quite verbose, and there isn&#8217;t any way to</p>
<p>specifya set of attributes that applies to a group of polygons&#8211;the</p>
<p>attributeslist must be repeated for each polygon.  This is why egg</p>
<p>filestend to be very large.</p>
<p>Thefollowing attributes may be specified for polygons:</p>
<p><TRef>{ texture-name }</p>
<p>Thisrefers to a named <Texture> entry given earlier.  It applies</p>
<p>thegiven texture to the polygon.  This requires that all the</p>
<p>polygon&#8217;svertices have been assigned texture coordinates.</p>
<p>Thisattribute may be repeated multiple times to specify</p>
<p>multitexture. In this case, each named texture is applied to the</p>
<p>polygon,in the order specified.</p>
<p><Texture>{ filename }</p>
<p>Thisis another way to apply a texture to a polygon.  The</p>
<p><Texture>entry is defined &#8220;inline&#8221; to the polygon, instead of</p>
<p>referringto a <Texture> entry given earlier.  There is no way to</p>
<p>specifytexture attributes given this form.</p>
<p>There&#8217;sno advantage to this syntax for texture mapping.  It&#8217;s</p>
<p>supportedonly because it&#8217;s required by some older egg files.</p>
<p><MRef>{ material-name }</p>
<p>Thisapplies the material properties defined in the earlier</p>
<p><Material>entry to the polygon.</p>
<p><Normal>{ x y z [morph-list] }</p>
<p>Thisdefines a polygon surface normal.  The polygon normal will be</p>
<p>usedunless all vertices also have a normal.  If no normal is</p>
<p>defined,none will be supplied.  The polygon normal, like the</p>
<p>vertexnormal, may be morphed by specifying a series of <DNormal></p>
<p>entries.</p>
<p>Thepolygon normal is used only for lighting and environment</p>
<p>mappingcalculations, and is not related to the implicit normal</p>
<p>calculatedfor CollisionPolygons.</p>
<p><RGBA>{ r g b a [morph-list] }</p>
<p>Thisdefines the polygon&#8217;s color, which will be used unless all</p>
<p>verticesalso have a color.  If no color is defined, the default</p>
<p>​    iswhite (1 1 1 1).  The color may be morphed with a series of</p>
<p><DRGBA>entries.</p>
<p><BFace>{ boolean-value }</p>
<p>Thisdefines whether the polygon will be rendered double-sided</p>
<p>(i.e.its back face will be visible).  By default, this option is</p>
<p>disabled,and polygons are one-sided; specifying a nonzero value</p>
<p>disablesbackface culling for this particular polygon and allows</p>
<p>​    itto be viewed from either side.</p>
<p>​</p>
<p><Scalar>bin { bin-name }</p>
<p>​    Itis sometimes important to control the order in which objects</p>
<p>arerendered, particularly when transparency is in use.  In Panda,</p>
<p>thisis achieved via the use of named bins and, within certain</p>
<p>kindsof bins, sometimes an explicit draw-order is also used (see</p>
<p>below).</p>
<p>​    Inthe normal (state-sorting) mode, Panda renders its geometry by</p>
<p>firstgrouping into one or more named bins, and then rendering the</p>
<p>binsin a specified order.  The programmer is free to define any</p>
<p>numberof bins, named whatever he/she desires.</p>
<p>Thisscalar specifies which bin this particular polygon is to be</p>
<p>renderedwithin.  If no bin scalar is given, or if the name given</p>
<p>doesnot match any of the known bins, the polygon will be assigned</p>
<p>​    tothe default bin, which renders all opaque geometry sorted by</p>
<p>state,followed by all transparent geometry sorted back-to-front.</p>
<p>Seealso draw-order, below.</p>
<p><Scalar>draw-order { number }</p>
<p>Thisworks in conjunction with bin, above, to further refine the</p>
<p>orderin which this polygon is drawn, relative to other geometry</p>
<p>​    inthe same bin.  If (and only if) the bin type named in the bin</p>
<p>scalaris a CullBinFixed, this draw-order is used to define the</p>
<p>fixedorder that all geometry in the same will be rendered, from</p>
<p>smallernumbers to larger numbers.</p>
<p>​    Ifthe draw-order scalar is specified but no bin scalar is</p>
<p>specified,the default is a bin named &#8220;fixed&#8221;, which is a</p>
<p>CullBinFixedobject that always exists by default.</p>
<p><Scalar>depth-offset { number }</p>
<p>Specifiesa special depth offset to be applied to the polygon.</p>
<p>Thismust be an integer value between 0 and 16 or so.  The default</p>
<p>valueis 0; values larger than 0 will cause the polygon to appear</p>
<p>closerto the camera for purposes of evaluating the depth buffer.</p>
<p>Thiscan be a simple way to resolve Z-fighting between coplanar</p>
<p>polygons:with two or more coplanar polygons, the polygon with the</p>
<p>highestdepth-offset value will appear to be visible on top.  Note</p>
<p>thatthis effect doesn&#8217;t necessarily work well when the polygons</p>
<p>areviewed from a steep angle.</p>
<p><Scalar>depth-write { mode }</p>
<p>Specifiesthe mode for writing to the depth buffer.  This may be</p>
<p>​    ONor OFF.  The default is ON.</p>
<p><Scalar>depth-test { mode }</p>
<p>Specifiesthe mode for testing against the depth buffer.  This may</p>
<p>​    beON or OFF.  The default is ON.</p>
<p><Scalar>visibility { hidden | normal }</p>
<p>​    Ifthe visibility of a primitive is set to &#8220;hidden&#8221;, theprimitive</p>
<p>​    isnot generated as a normally visible primitive.  If the</p>
<p>Config.prcvariable egg-suppress-hidden is set to true, the</p>
<p>primitiveis not converted at all; otherwise, it is converted as a</p>
<p>&#8220;stashed&#8221;node.</p>
<p>This,like the other rendering flags alpha, draw-order, and bin,</p>
<p>maybe specified at the group level, within the primitive level,</p>
<p>​    oreven within a texture.</p>
<p><Patch>name {</p>
<p>[attributes]</p>
<p><VertexRef>{</p>
<p>​       indices</p>
<p>​       <Ref>{ pool-name }</p>
<p>​    }</p>
<p>}</p>
<p>Apatch is similar to a polygon, but it is a special primitive that</p>
<p>canonly be rendered with the use of a tessellation shader.  Each</p>
<p>patchconsists of an arbitrary number of vertices; all patches with</p>
<p>thesame number of vertices are collected together into the same</p>
<p>GeomPatchesobject to be delivered to the shader in a single batch.</p>
<p>Itis then up to the shader to create the correct set of triangles</p>
<p>fromthe patch data.</p>
<p>Allof the attributes that are valid for Polygon, above, may also be</p>
<p>specifiedfor Patch.</p>
<p><PointLight>name {</p>
<p>[attributes]</p>
<p><VertexRef>{</p>
<p>​       indices</p>
<p>​       <Ref>{ pool-name }</p>
<p>​    }</p>
<p>}</p>
<p>APointLight is a set of single points.  One point is drawn for each</p>
<p>vertexlisted in the <VertexRef>.  Normals, textures, and colors may</p>
<p>bespecified for PointLights, as well as draw-order, plus one</p>
<p>additionalattribute valid only for PointLights and Lines:</p>
<p><Scalar>thick { number }</p>
<p>Thisspecifies the size of the PointLight (or the width of a</p>
<p>line),in pixels, when it is rendered.  This may be a</p>
<p>floating-pointnumber, but the fractional part is meaningful only</p>
<p>whenantialiasing is in effect.  The default is 1.0.</p>
<p><Scalar>perspective { boolean-value }</p>
<p>​    Ifthis is specified, then the thickness, above, is to interpreted</p>
<p>​    asa size in 3-d spatial units, rather than a size in pixels, and</p>
<p>thepoint should be scaled according to its distance from the</p>
<p>viewernormally.</p>
<p><Line>name {</p>
<p>[attributes]</p>
<p><VertexRef>{</p>
<p>​       indices</p>
<p>​       <Ref>{ pool-name }</p>
<p>​    }</p>
<p>[componentattributes]</p>
<p>}</p>
<p>ALine is a connected set of line segments.  The listed N vertices</p>
<p>definea series of N-1 line segments, drawn between vertex 0 and</p>
<p>vertex1, vertex 1 and vertex 2, etc.  The line is not implicitly</p>
<p>closed;if you wish to represent a loop, you must repeat vertex 0 at</p>
<p>theend.  As with a PointLight, normals, textures, colors,</p>
<p>draw-order,and the &#8220;thick&#8221; attribute are all valid (but not</p>
<p>&#8220;perspective&#8221;). Also, since a Line (with more than two vertices) is</p>
<p>madeup of multiple line segments, it may contain a number of</p>
<p><Component>entries, to set a different color and/or normal for each</p>
<p>linesegment, as in TriangleStrip, below.</p>
<p><TriangleStrip>name {</p>
<p>[attributes]</p>
<p><VertexRef>{</p>
<p>​       indices</p>
<p>​       <Ref>{ pool-name }</p>
<p>​    }</p>
<p>[componentattributes]</p>
<p>}</p>
<p>Atriangle strip is only rarely encountered in an egg file; it is</p>
<p>normallygenerated automatically only during load time, when</p>
<p>connectedtriangles are automatically meshed for loading, and even</p>
<p>thenit exists only momentarily.  Since a triangle strip is a</p>
<p>renderingoptimization only and adds no useful scene information</p>
<p>overa loose collection of triangles, its usage is contrary to the</p>
<p>generalegg philosophy of representing a scene in the abstract.</p>
<p>Nevertheless,the syntax exists, primarily to allow inspection of</p>
<p>themeshing results when needed.  You can also add custom</p>
<p>TriangleStripentries to force a particular mesh arrangement.</p>
<p>Atriangle strip is defined as a series of connected triangles.</p>
<p>Afterthe first three vertices, which define the first triangle,</p>
<p>eachnew vertex defines one additional triangle, by alternating up</p>
<p>anddown.</p>
<p>Itis possible for the individual triangles of a triangle strip to</p>
<p>havea separate normal and/or color.  If so, a <Component> entry</p>
<p>shouldbe given for each so-modified triangle:</p>
<p><Component>index {</p>
<p><RGBA>{ r g b a [morph-list] }</p>
<p><Normal>{ x y z [morph-list] }</p>
<p>}</p>
<p>Whereindex ranges from 0 to the number of components defined by the</p>
<p>trianglestrip (less 1).  Note that the component attribute list</p>
<p>mustalways follow the vertex list.</p>
<p><TriangleFan>name {</p>
<p>[attributes]</p>
<p><VertexRef>{</p>
<p>​       indices</p>
<p>​       <Ref>{ pool-name }</p>
<p>​    }</p>
<p>[componentattributes]</p>
<p>}</p>
<p>Atriangle fan is similar to a triangle strip, except all of the</p>
<p>connectedtriangles share the same vertex, which is the first</p>
<p>vertex. See <TriangleStrip>, above.</p>
</div>
<div class="section" id="parametricdescription-entries">
<span id="parametricdescription-entries"></span><h3>PARAMETRICDESCRIPTION ENTRIES<a class="headerlink" href="#parametricdescription-entries" title="Permalink to this headline">¶</a></h3>
<p>Thefollowing entries define parametric curves and surfaces.</p>
<p>Generally,Panda supports these only in the abstract; they&#8217;re not</p>
<p>geometryin the true sense but do exist in the scene graph and may</p>
<p>havespecific meaning to the application.  However, Panda can create</p>
<p>visiblerepresentations of these parametrics to aid visualization.</p>
<p>Theseentries might also have meaning to external tools outside of an</p>
<p>interactivePanda session, such as egg-qtess, which can be used to</p>
<p>convertNURBS surfaces to polygons at different levels of resolution.</p>
<p>Ingeneral, dynamic attributes such as morphs and joint assignment are</p>
<p>legalfor the control vertices of the following parametrics, but Panda</p>
<p>itselfdoesn&#8217;t support them and will always create static curves and</p>
<p>surfaces. External tools like egg-qtess, however, may respect them.</p>
<p><NURBSCurve>{</p>
<p>[attributes]</p>
<p><Order>{order}</p>
<p><Knots>{knot-list}</p>
<p><VertexRef>{indices<Ref>{pool-name}}</p>
<p>}</p>
<p>ANURBS curve is a general parametric curve.  It is often used to</p>
<p>representa motion path, e.g. for a camera or an object.</p>
<p>Theorder is equal to the degree of the polynomial basis plus 1.  It</p>
<p>mustbe an integer in the range [1,4].</p>
<p>Thenumber of vertices must be equal to the number of knots minus the</p>
<p>order.</p>
<p>Eachcontrol vertex of a NURBS is defined in homogeneous space with</p>
<p>fourcoordinates x y z w (to convert to 3-space, divide x, y, and z</p>
<p>byw).  The last coordinate is always the homogeneous coordinate; if</p>
<p>onlythree coordinates are given, it specifies a curve in two</p>
<p>dimensionsplus a homogeneous coordinate (x y w).</p>
<p>Thefollowing attributes may be defined:</p>
<p><Scalar>type{curve-type}</p>
<p>Thisdefines the semanting meaning of this curve, either XYZ, HPR,</p>
<p>​    orT.  If the type is XYZ, the curve will automatically be</p>
<p>transformedbetween Y-up and Z-up if necessary; otherwise, it will</p>
<p>​    beleft alone.</p>
<p><Scalar>subdiv{num-segments}</p>
<p>​    Ifthis scalar is given and nonzero, Panda will create a visible</p>
<p>representationof the curve when the scene is loaded.  The number</p>
<p>representsthe number of line segments to draw to approximate the</p>
<p>curve.</p>
<p><RGBA>{rgba[morph-list]}</p>
<p>Thisspecifies the color of the overall curve.</p>
<p>NURBScontrol vertices may also be given color and/or morph</p>
<p>attributes,but <Normal> and <UV> entries do not apply to NURBS</p>
<p>vertices.</p>
<p><NURBSSurface>name{</p>
<p>[attributes]</p>
<p><Order>{u-orderv-order}</p>
<p>&lt;U-knots&gt;{u-knot-list}</p>
<p>&lt;V-knots&gt;{v-knot-list}</p>
<p><VertexRef>{</p>
<p>​       indices</p>
<p>​       <Ref>{pool-name}</p>
<p>​    }</p>
<p>}</p>
<p>ANURBS surface is an extension of a NURBS curve into two parametric</p>
<p>dimensions,u and v.  NURBS surfaces may be given the same set of</p>
<p>attributesassigned to polygons, except for normals: <TRef>,</p>
<p><Texture>,<MRef>, <RGBA>, and draw-order are all valid attributes</p>
<p>forNURBS.  NURBS vertices, similarly, may be colored or morphed,</p>
<p>but<Normal> and <UV> entries do not apply to NURBS vertices. The</p>
<p>attributesmay also include <NURBSCurve> and <Trim> entries; see</p>
<p>below.</p>
<p>Tohave Panda create a visualization of a NURBS surface, the</p>
<p>followingtwo attributes should be defined as well:</p>
<p><Scalar>U-subdiv{u-num-segments}</p>
<p><Scalar>V-subdiv{v-num-segments}</p>
<p>Thesedefine the number of subdivisions to make in the U and V</p>
<p>directionsto represent the surface.  A uniform subdivision is</p>
<p>alwaysmade, and trim curves are not respected (though they will</p>
<p>​    bedrawn in if the trim curves themselves also have a subiv</p>
<p>parameter). This is only intended as a cheesy visualization.</p>
<p>Thesame sort of restrictions on order and knots applies to NURBS</p>
<p>surfacesas do to NURBS curves.  The order and knot description may</p>
<p>bedifferent in each dimension.</p>
<p>Thesurface must have u-num * v-num vertices, where u-num is the</p>
<p>numberof u-knots minus the u-order, and v-num is the number of</p>
<p>v-knotsminus the v-order.  All vertices must come from the same</p>
<p>vertexpool.  The nth (zero-based) index number defines control</p>
<p>vertex(u, v) of the surface, where n = (v * u-num) + u.  Thus, it</p>
<p>isthe u coordinate which changes faster.</p>
<p>Aswith the NURBS curve, each control vertex is defined in</p>
<p>homogeneousspace with four coordinates x y z w.</p>
<p>ANURBS may also contain curves on its surface.  These are one or</p>
<p>morenested <NURBSCurve> entries included with the attributes; these</p>
<p>curvesare defined in the two-dimensional parametric space of the</p>
<p>surface. Thus, these curve vertices should have only two dimensions</p>
<p>plusthe homogeneous coordinate: u v w.  A curve-on-surface has no</p>
<p>intrinsicmeaning to the surface, unless it is defined within a</p>
<p><Trim>entry, below.</p>
<p>Finally,a NURBS may be trimmed by one or more trim curves.  These</p>
<p>arespecial curves on the surface which exclude certain areas from</p>
<p>theNURBS surface definition.  The inside is specified using two</p>
<p>rules:an odd winding rule that states that the inside consists of</p>
<p>allregions for which an infinite ray from any point in the region</p>
<p>willintersect the trim curve an odd number of times, and a curve</p>
<p>orientationrule that states that the inside consists of the regions</p>
<p>tothe left as the curve is traced.</p>
<p>Eachtrim curve contains one or more loops, and each loop contains</p>
<p>oneor more NURBS curves.  The curves of a loop connect in a</p>
<p>head-to-tailfashion and must be explicitly closed.</p>
<p>Thetrim curve syntax is as follows:</p>
<p><Trim>{</p>
<p><Loop>{</p>
<p>​     <NURBSCurve>{</p>
<p>​       <Order>{order}</p>
<p>​   <Knots>{knot-list}</p>
<p>​   <VertexRef>{indices<Ref>{pool-name}}</p>
<p>​     }</p>
<p>​     [<NURBSCurve>{...}...]</p>
<p>​    }</p>
<p>​    [<Loop>{...}...]</p>
<p>}</p>
<p>Althoughthe egg syntax supports trim curves, there are at present</p>
<p>noegg processing tools that respect them.  For instance, egg-qtess</p>
<p>ignorestrim curves and always tesselates the entire NURBS surface.</p>
</div>
<div class="section" id="morphdescription-entries">
<span id="morphdescription-entries"></span><h3>MORPHDESCRIPTION ENTRIES<a class="headerlink" href="#morphdescription-entries" title="Permalink to this headline">¶</a></h3>
<p>Morphsare linear interpolations of attribute values at run time,</p>
<p>accordingto values read from an animation table.  In general, vertex</p>
<p>positions,surface normals, texture coordinates, and colors may be</p>
<p>morphed.</p>
<p>Amorph target is defined by giving a net morph offset for a series of</p>
<p>vertexor polygon attributes; this offset is the value that will be</p>
<p>addedto the attribute when the morph target has the value 1.0.  At</p>
<p>runtime, the morph target&#8217;s value may be animated to any scalar value</p>
<p>(butgenerally between 0.0 and 1.0); the corresponding fraction of the</p>
<p>offsetis added to the attribute each frame.</p>
<p>Thereis no explicit morph target definition; a morph target exists</p>
<p>solelyas the set of all offsets that share the same target name.  The</p>
<p>targetname may be any arbitrary string; like any name in an egg file,</p>
<p>itshould be quoted if it contains special characters.</p>
<p>Thefollowing types of morph offsets may be defined, within their</p>
<p>correspondingattribute entries:</p>
<p><Dxyz>target{xyz}</p>
<p>Aposition delta, valid within a <Vertex> entry or a <CV>entry.</p>
<p>Thegiven offset vector, scaled by the morph target&#8217;s value, is</p>
<p>addedto the vertex or CV position each frame.</p>
<p><DNormal>target{xyz}</p>
<p>Anormal delta, similar to the position delta, valid within a</p>
<p><Normal>entry (for vertex or polygon normals).  The given offset</p>
<p>vector,scaled by the morph target&#8217;s value, is added to the normal</p>
<p>vectoreach frame.  The resulting vector may not be automatically</p>
<p>normalizedto unit length.</p>
<p><DUV>target{uv[w]}</p>
<p>Atexture-coordinate delta, valid within a <UV> entry (within a</p>
<p><Vertex>entry).  The offset vector should be 2-valued if the</p>
<p>enclosingUV is 2-valued, or 3-valued if the enclosing UV is</p>
<p>3-valued. The given offset vector, scaled by the morph target&#8217;s</p>
<p>value,is added to the vertex&#8217;s texture coordinates each frame.</p>
<p><DRGBA>target{rgba}</p>
<p>Acolor delta, valid within an <RGBA> entry (for vertex orpolygon colors).  The given 4-valued offset vector, scaled by themorph</p>
<p>target&#8217;svalue, is added to the color value each frame.</p>
</div>
<div class="section" id="groupingentries">
<span id="groupingentries"></span><h3>GROUPINGENTRIES<a class="headerlink" href="#groupingentries" title="Permalink to this headline">¶</a></h3>
<p><Group>name{group-body}</p>
<p>A<Group> node is the primary means of providing structure to the</p>
<p>eggfile.  Groups can contain vertex pools and polygons, as well as</p>
<p>othergroups.  The egg loader translates <Group> nodes directly into</p>
<p>PandaNodesin the scene graph (although the egg loader reserves the</p>
<p>rightto arbitrarily remove nodes that it deems unimportant&#8211;see the</p>
<p><Model>flag, below to avoid this).  In addition, the following</p>
<p>entriescan be given specifically within a <Group> node to specify</p>
<p>attributesof the group:</p>
</div>
<div class="section" id="groupbinary-attributes">
<span id="groupbinary-attributes"></span><h3>GROUPBINARY ATTRIBUTES<a class="headerlink" href="#groupbinary-attributes" title="Permalink to this headline">¶</a></h3>
<p>Theseattributes may be either on or off; they are off by default.</p>
<p>Theyare turned on by specifying a non-zero &#8220;boolean-value&#8221;.</p>
<p><DCS>{boolean-value}</p>
<p>DCSstands for Dynamic Coordinate System.  This indicates that</p>
<p>showcode will expect to be able to read the transform set on this</p>
<p>nodeat run time, and may need to modify the transform further.</p>
<p>Thisis a special case of <Model>, below.</p>
<p><DCS>{dcs-type}</p>
<p>Thisis another syntax for the <DCS> flag.  The dcs-type string</p>
<p>shouldbe one of either &#8220;local&#8221; or &#8220;net&#8221;, whichspecifies the kind</p>
<p>​    ofpreserve_transform flag that will be set on the corresponding</p>
<p>ModelNode. If the string is &#8220;local&#8221;, it indicates that the local</p>
<p>transformon this node (as well as the net transform) will not be</p>
<p>affectedby any flattening operation and will be preserved through</p>
<p>theentire model loading process.  If the string is &#8220;net&#8221;, then</p>
<p>onlythe net transform will be preserved; the local transform may</p>
<p>​    beadjusted in the event of a flatten operation.</p>
<p><Model>{boolean-value}</p>
<p>Thisindicates that the show code might need a pointer to this</p>
<p>particulargroup.  This creates a ModelNode at the corresponding</p>
<p>level,which is guaranteed not to be removed by any flatten</p>
<p>operation. However, its transform might still be changed, but see</p>
<p>alsothe <DCS> flag, above.</p>
<p><Dart>{boolean-value}</p>
<p>Thisindicates that this group begins an animated character.  A</p>
<p>Characternode, which is the fundamental animatable object of</p>
<p>Panda&#8217;shigh-level Actor class, will be created for this group.</p>
<p>Thisflag should always be present within the <Group> entry at the</p>
<p>topof any hierarchy of <Joint>&#8216;s and/or geometry with morphed</p>
<p>vertices;joints and morphs appearing outside of a hierarchy</p>
<p>identifiedwith a <Dart> flag are undefined.</p>
<p><Switch>{boolean-value}</p>
<p>Thisattribute indicates that the child nodes of this group</p>
<p>representa series of animation frames that should be</p>
<p>consecutivelydisplayed.  In the absence of an &#8220;fps&#8221; scalar for</p>
<p>thegroup (see below), the egg loader creates a SwitchNode, and it</p>
<p>theresponsibility of the show code to perform the switching.  If</p>
<p>​    anfps scalar is defined and is nonzero, the egg loader creates a</p>
<p>SequenceNodeinstead, which automatically cycles through its</p>
<p>children.</p>
</div>
<div class="section" id="groupscalars">
<span id="groupscalars"></span><h3>GROUPSCALARS<a class="headerlink" href="#groupscalars" title="Permalink to this headline">¶</a></h3>
<p><Scalar>fps{frame-rate}</p>
<p>Thisspecifies the rate of animation for a SequenceNode (created</p>
<p>whenthe Switch flag is specified, see above).  A value of zero</p>
<p>indicatesa SwitchNode should be created instead.</p>
<p><Scalar>bin{bin-name}</p>
<p>Thisspecifies the bin name for all polygons at or below this node</p>
<p>thatdo not explicitly set their own bin.  See the description of</p>
<p>binfor geometry attributes, above.</p>
<p><Scalar>draw-order{number}</p>
<p>Thisspecifies the drawing order for all polygons at or below this</p>
<p>nodethat do not explicitly set their own drawing order.  See the</p>
<p>descriptionof draw-order for geometry attributes, above.</p>
<p><Scalar>depth-offset{number}</p>
<p><Scalar>depth-write{mode}</p>
<p><Scalar>depth-test{mode}</p>
<p>Specifiesspecial depth buffer properties of all polygons at or</p>
<p>belowthis node that do not override this.  See the descriptions</p>
<p>forthe individual attributes under polygon attributes.</p>
<p><Scalar>visibility{hidden|normal}</p>
<p>​    Ifthe visibility of a group is set to &#8220;hidden&#8221;, theprimitives</p>
<p>nestedwithin that group are not generated as a normally visible</p>
<p>primitive. If the Config.prc variable egg-suppress-hidden is set</p>
<p>​    totrue, the primitives are not converted at all; otherwise, they</p>
<p>areconverted as a &#8220;stashed&#8221; node.</p>
<p><Scalar>decal{boolean-value}</p>
<p>​    Ifthis is present and boolean-value is non-zero, it indicates</p>
<p>thatthe geometry <em>below</em> this level is coplanar with the geometry</p>
<p><em>at</em>this level, and the geometry below is to be drawn as a decal</p>
<p>ontothe geometry at this level.  This means the geometry below</p>
<p>thislevel will be rendered &#8220;on top of&#8221; this geometry, butwithout</p>
<p>theZ-fighting artifacts one might expect without the use of the</p>
<p>decalflag.</p>
<p><Scalar>decalbase{boolean-value}</p>
<p>Thiscan optionally be used with the &#8220;decal&#8221; scalar, above.  If</p>
<p>present,it should be applied to a sibling of one or more nodes</p>
<p>withthe &#8220;decal&#8221; scalar on.  It indicates which of the sibling</p>
<p>nodesshould be treated as the base of the decal.  In the absence</p>
<p>​    ofthis scalar, the parent of all decal nodes is used as the decal</p>
<p>base. This scalar is useful when the modeling package is unable</p>
<p>​    toparent geometry nodes to other geometry nodes.</p>
<p><Scalar>collide-mask{value}</p>
<p><Scalar>from-collide-mask{value}</p>
<p><Scalar>into-collide-mask{value}</p>
<p>​     Setsthe CollideMasks on the collision nodes and geometry nodes</p>
<p>​     createdat or below this group to the indicated values.  These</p>
<p>​     arebits that indicate which objects can collide with which</p>
<p>​     otherobjects.  Setting &#8220;collide-mask&#8221; is equivalent to setting</p>
<p>​     both&#8221;from-collide-mask&#8221; and &#8220;into-collide-mask&#8221; tothe same</p>
<p>​     value.</p>
<p>​     Thevalue may be an ordinary decimal integer, or a hex number in</p>
<p>​     theform 0x000, or a binary number in the form 0b000.</p>
<p><Scalar>blend{mode}</p>
<p>Specifiesthat a special blend mode should be applied geometry at</p>
<p>thislevel and below.  The available options are none, add,</p>
<p>subtract,inv-subtract, min, and max.  See ColorBlendAttrib.</p>
<p><Scalar>blendop-a{mode}</p>
<p><Scalar>blendop-b{mode}</p>
<p>​    Ifblend mode, above, is not none, this specifies the A and B</p>
<p>operandsto the blend equation.  Common options are zero, one,</p>
<p>incoming-color,one-minus-incoming-color.  See ColorBlendAttrib</p>
<p>forthe complete list of available options.  The default is &#8220;one&#8221;.</p>
<p><Scalar>blendr{red-value}</p>
<p><Scalar>blendg{green-value}</p>
<p><Scalar>blendb{blue-value}</p>
<p><Scalar>blenda{alpha-value}</p>
<p>​    Ifblend mode, above, is not none, and one of the blend operands</p>
<p>​    isconstant-color or a related option, this defines the constant</p>
<p>colorthat will be used.</p>
<p><Scalar>occluder{boolean-value}</p>
<p>Thismakes the first (or only) polygon within this group node into</p>
<p>​    anoccluder.  The polygon must have exactly four vertices.  An</p>
<p>occluderpolygon is invisible.  When the occluder is activated</p>
<p>withmodel.set_occluder(occluder), objects that are behind the</p>
<p>occluderwill not be drawn.  This can be a useful rendering</p>
<p>optimizationfor complex scenes, but should not be overused or</p>
<p>performancecan suffer.</p>
</div>
<div class="section" id="othergroup-attributes">
<span id="othergroup-attributes"></span><h3>OTHERGROUP ATTRIBUTES<a class="headerlink" href="#othergroup-attributes" title="Permalink to this headline">¶</a></h3>
<p><Billboard>{type}</p>
<p>Thisentry indicates that all geometry defined at or below this</p>
<p>grouplevel is part of a billboard that will rotate to face the</p>
<p>camera. Type is either &#8220;axis&#8221; or &#8220;point&#8221;, describing thetype of</p>
<p>rotation.</p>
<p>Billboardsrotate about their local axis.  In the case of a Y-up</p>
<p>file,the billboards rotate about the Y axis; in a Z-up file, they</p>
<p>rotateabout the Z axis.  Point-rotation billboards rotate about</p>
<p>theorigin.</p>
<p>Thereis an implicit <Instance> around billboard geometry.  This</p>
<p>meansthat the geometry within a billboard is not specified in</p>
<p>worldcoordinates, but in the local billboard space.  Thus, a</p>
<p>vertexdrawn at point 0,0,0 will appear to be at the pivot point</p>
<p>​    ofthe billboard, not at the origin of the scene.</p>
<p><SwitchCondition>{</p>
<p>​    <Distance>{</p>
<p>​       inout[fade]<Vertex>{xyz}</p>
<p>​     }</p>
<p>}</p>
<p>Thesubtree beginning at this node and below represents a single</p>
<p>levelof detail for a particular model.  Sibling nodes represent</p>
<p>theadditional levels of detail.  The geometry at this node will</p>
<p>​    bevisible when the point (x, y, z) is closer than &#8220;in&#8221; units,but</p>
<p>furtherthan &#8220;out&#8221; units, from the camera.  &#8220;fade&#8221; ispresently</p>
<p>ignored.</p>
<p><Tag>key{value}</p>
<p>Thisattribute defines the indicated tag (as a key/value pair),</p>
<p>retrievablevia NodePath::get_tag() and related interfaces, on</p>
<p>thisnode.</p>
</div>
<div class="section" id="collide-name-type-flags">
<span id="collide-name-type-flags"></span><h3><Collide>name { type [flags] }<a class="headerlink" href="#collide-name-type-flags" title="Permalink to this headline">¶</a></h3>
<p>Thisentry indicates that geometry defined at this group level is</p>
<p>actuallyan invisible collision surface, and is not true geometry.</p>
<p>Thegeometry is used to define the extents of the collision</p>
<p>surface. If there is no geometry defined at this level, then a</p>
<p>childis searched for with the same collision type specified, and</p>
<p>itsgeometry is used to define the extent of the collision</p>
<p>surface(unless the &#8220;descend&#8221; flag is given; see below).</p>
<p>Validtypes so far are:</p>
<p><strong>Plane</strong></p>
<p>​</p>
<p>​     Thegeometry represents an infinite plane.  The first polygon</p>
<p>​     foundin the group will define the plane.</p>
<p><strong>Polygon</strong></p>
<p>​     Thegeometry represents a single polygon.  The first polygon is</p>
<p>​     used.</p>
<p><strong>Polyset</strong></p>
<p>​     Thegeometry represents a complex shape made up of several</p>
<p>​     polygons. This collision type should not be overused, as it</p>
<p>​     providesthe least optimization benefit.</p>
<p><strong>Sphere</strong></p>
<p>​     Thegeometry represents a sphere.  The vertices in the group are</p>
<p>​     averagedtogether to determine the sphere&#8217;s center and radius.</p>
<p><strong>Box</strong></p>
<p>​     Thegeometry represents a box.  The smalles axis-alligned box</p>
<p>​     thatwill fit around the vertices is used.</p>
<p><strong>InvSphere</strong></p>
<p>​     Thegeometry represents an inverse sphere.  This is the same as</p>
<p>​     Sphere,with the normal inverted, so that the solid part of an</p>
<p>​     inversesphere is the entire world outside of it.  Note that an</p>
<p>​     inversesphere is in infinitely large solid with a finite hole</p>
<p>​     cutinto it.</p>
<p><strong>Tube</strong></p>
<p>​     Thegeometry represents a tube.  This is a cylinder-like shape</p>
<p>​     withhemispherical endcaps; it is sometimes called a capsule or</p>
<p>​     alozenge in other packages.  The smallest tube shape that will</p>
<p>​     fitaround the vertices is used.</p>
<p>Theflags may be any zero or more of:</p>
<p>event</p>
<p>​     Throwsthe name of the <Collide> entry, or the name of the</p>
<p>​     surfaceif the <Collide> entry has no name, as an event whenever</p>
<p>​     anavatar strikes the solid.  This is the default if the</p>
<p>​     <Collide>entry has a name.</p>
<p>intangible</p>
<p>​     Ratherthan being a solid collision surface, the defined surface</p>
<p>​     representsa boundary.  The name of the surface will be thrown</p>
<p>​     asan event when an avatar crosses into the interior, and</p>
<p>​     name-outwill be thrown when an avater exits.</p>
<p>descend</p>
<p>​     Insteadof creating only one collision object of the given type,</p>
<p>​     eachgroup descended from this node that contains geometry will</p>
<p>​     definea new collision object of the given type.  The event</p>
<p>​     name,if any, will also be inherited from the top node and</p>
<p>​     sharedamong all the collision objects.</p>
<p>keep</p>
<p>​     Don&#8217;tdiscard the visible geometry after using it to define a</p>
<p>​     collisionsurface; create both an invisible collision surface</p>
<p>​     andthe visible geometry.</p>
<p>level</p>
<p>​     Storesa special effective normal with the collision solid that</p>
<p>​     pointsup, regardless of the actual shape or orientation of the</p>
<p>​     solid. This can be used to allow an avatar to stand on a</p>
<p>​     slopingsurface without having a tendency to slide downward.</p>
</div>
<div class="section" id="objecttype-type">
<span id="objecttype-type"></span><h3><ObjectType>{type}<a class="headerlink" href="#objecttype-type" title="Permalink to this headline">¶</a></h3>
<p>Thisis a short form to indicate one of several pre-canned sets of</p>
<p>attributes. Type may be any word, and a Config definition will be</p>
<p>searchedfor by the name &#8220;egg-object-type-word&#8221;, where &#8220;word&#8221;is</p>
<p>thetype word.  This definition may contain any arbitrary egg</p>
<p>syntaxto be parsed in at this group level.</p>
<p>​    Anumber of predefined ObjectType definitions are provided:</p>
<p><strong>barrier</strong></p>
<p>​     Thisis equivalent to <Collide> { Polyset descend }.  The</p>
<p>​     geometrydefined at this root and below defines an invisible</p>
<p>​     collisionsolid.</p>
<p><strong>trigger</strong></p>
<p>​     Thisis equivalent to <Collide> { Polyset descend intangible }.</p>
<p>​     Thegeometry defined at this root and below defines an invisible</p>
<p>​     triggersurface.</p>
<p><strong>sphere</strong></p>
<p>​     Equivalentto <Collide> { Sphere descend }.  The geometry is</p>
<p>​     replacedwith the smallest collision sphere that will enclose</p>
<p>​     it. Typically you model a sphere in polygons and put this flag</p>
<p>​     onit to create a collision sphere of the same size.</p>
<p><strong>tube</strong></p>
<p>​     Equivalentto <Collide> { Tube descend }.  As in sphere, above,</p>
<p>​     butthe geometry is replaced with a collision tube (a capsule).</p>
<p>​     Typicallyyou will model a capsule or a cylinder in polygons.</p>
<p><strong>bubble</strong></p>
<p>​     Equivalentto <Collide> { Sphere keep descend }.  A collision</p>
<p>​     bubbleis placed around the geometry, which is otherwise</p>
<p>​     unchanged.</p>
<p><strong>ghost</strong></p>
<p>​     Equivalentto <Scalar> collide-mask { 0 }.  It means that the</p>
<p>​     geometrybeginning at this node and below should never be</p>
<p>​     collidedwith&#8211;characters will pass through it.</p>
<p><strong>backstage</strong></p>
<p>​     Thishas no equivalent; it is treated as a special case.  It</p>
<p>​     meansthat the geometry at this node and below should not be</p>
<p>​     translated. This will normally be used on scale references and</p>
<p>​     othermodeling tools.</p>
<p>Theremay also be additional predefined egg object types not</p>
<p>listedhere; see the *.pp files that are installed into the etc</p>
<p>directoryfor a complete list.</p>
<p><Transform>{transform-definition}</p>
<p>Thisspecifies a matrix transform at this group level.  This</p>
<p>definesa local coordinate space for this group and its</p>
<p>descendents. Vertices are still specified in world coordinates</p>
<p>(ina vertex pool), but any geometry assigned to this group will</p>
<p>​    beinverse transformed to move its vertices to the local space.</p>
<p>Thetransform definition may be any sequence of zero or more of</p>
<p>thefollowing.  Transformations are post multiplied in the order</p>
<p>theyare encountered to produce a net transformation matrix.</p>
<p>Rotationsare defined as a counterclockwise angle in degrees about</p>
<p>​    aparticular axis, either implicit (about the x, y, or z axis), or</p>
<p>arbitrary. Matrices, when specified explicitly, are row-major.</p>
<p>​     <Translate>{xyz}</p>
<p>​     <RotX>{degrees}</p>
<p>​     <RotY>{degrees}</p>
<p>​     <RotZ>{degrees}</p>
<p>​     <Rotate>{degreesxyz}</p>
<p>​     <Scale>{xyz}</p>
<p>​     <Scale>{s}</p>
<p>​     <Matrix4>{</p>
<p>​       00010203</p>
<p>​       10111213</p>
<p>​       20212223</p>
<p>​       30313233</p>
<p>​     }</p>
<p>Notethat the <Transform> block should always define a 3-d</p>
<p>transformwhen it appears within the body of a <Group>, while it</p>
<p>maydefine either a 2-d or a 3-d transform when it appears within</p>
<p>thebody of a <Texture>.  See <Texture>, above.</p>
<p><DefaultPose>{transform-definition}</p>
<p>Thisdefines an optional default pose transform, which might be a</p>
<p>differenttransform from that defined by the <Transform> entry,</p>
<p>above. This makes sense only for a <Joint>.  See the <Joint></p>
<p>description,below.</p>
<p>Thedefault pose transform defines the transform the joint will</p>
<p>maintainin the absence of any animation being applied.  This is</p>
<p>differentfrom the <Transform> entry, which defines the coordinate</p>
<p>spacethe joint must have in order to keep its vertices in their</p>
<p>(globalspace) position as given in the egg file.  If this is</p>
<p>differentfrom the <Transform> entry, the joint&#8217;s vertices will</p>
<p><em>not</em>be in their egg file position at initial load.  If there is</p>
<p>​    no<DefaultPose> entry for a particular joint, the implicit</p>
<p>default-posetransform is the same as the <Transform> entry.</p>
<p>Normally,the <DefaultPose> entry, if any, is created by the</p>
<p>egg-optchar-defpose option.  Most other software has little</p>
<p>reasonto specify an explicit <DefaultPose>.</p>
<p><VertexRef>{indices<Ref>{pool-name}}</p>
<p>Thismoves geometry created from the named vertices into the</p>
<p>currentgroup, regardless of the group in which the geometry is</p>
<p>actuallydefined.  See the <Joint> description, below.</p>
<p><AnimPreload>{</p>
<p><Scalar>fps{float-value}</p>
<p><Scalar>num-frames{integer-value}</p>
<p>}</p>
<p>Oneor more AnimPreload entries may appear within the <Group> that</p>
<p>containsa <Dart> entry, indicating an animated character (see</p>
<p>above). These AnimPreload entries record the minimal preloaded</p>
<p>animationdata required in order to support asynchronous animation</p>
<p>binding. These entries are typically generated by the egg-optchar</p>
<p>programwith the -preload option, and are used by the Actor code</p>
<p>whenallow-async-bind is True (the default).</p>
<p><Instance>name{group-body}</p>
<p>An<Instance> node is exactly like a <Group> node, exceptthat</p>
<p>verticesreferenced by geometry created under the <Instance> node</p>
<p>arenot assumed to be given in world coordinates, but are instead</p>
<p>givenin the local space of the <Instance> node itself (including</p>
<p>anytransforms given to the node).</p>
<p>Inother words, geometry under an <Instance> node is defined in</p>
<p>localcoordinates.  In principle, similar geometry can be created</p>
<p>underseveral different <Instance> nodes, and thus can be positioned</p>
<p>ina different place in the scene each instance.  This doesn&#8217;t</p>
<p>necessarilyimply the use of shared geometry in the Panda3D scene</p>
<p>graph,but see the <Ref> syntax, below.</p>
<p>Thisis particularly useful in conjunction with a <File> entry, to</p>
<p>loadexternal file references at places other than the origin.</p>
<p>Aspecial syntax of <Instance> entries does actually createshared</p>
<p>geometryin the scene graph.  The syntax is:</p>
<p><Instance>name{</p>
<p><Ref>{group-name}</p>
<p>[<Ref>{group-name}...]</p>
<p>}</p>
<p>Inthis case, the referenced group name will appear as a duplicate</p>
<p>instancein this part of the tree.  Local transforms can be applied</p>
<p>andare relative to the referencing group&#8217;s transform.  The</p>
<p>referencedgroup must appear preceding this point in the egg file,</p>
<p>andit will also be a part of the scene in the point at which it</p>
<p>firstappears.  The referenced group may be either a <Group> or an</p>
<p><Instance>of its own; usually, it is a <Group> nested within an</p>
<p>earlier<Instance> entry.</p>
<p><Joint>name{[transform][ref-list][joint-list]}</p>
<p>Ajoint is a highly specialized kind of grouping node.  A tree of</p>
<p>jointsis used to specify the skeletal structure of an animated</p>
<p>character.</p>
<p>Ajoint may only contain one of three things.  It may contain a</p>
<p><Transform>entry, as above, which defines the joint&#8217;s unanimated</p>
<p>(rest)position; it may contain lists of assigned vertices or CV&#8217;s;</p>
<p>andit may contain other joints.</p>
<p>Atree of <Joint> nodes only makes sense within a character</p>
<p>definition,which is created by applying the <DART> flag to a group.</p>
<p>See<DART>, above.</p>
<p>Thevertex assignment is crucial.  This is how the geometry of a</p>
<p>characteris made to move with the joints.  The character&#8217;s geometry</p>
<p>isactually defined outside the joint tree, and each vertex must be</p>
<p>assignedto one or more joints within the tree.</p>
<p>Thisis done with zero or more <VertexRef> entries per joint, as the</p>
<p>following:</p>
<p><VertexRef>{indices[<Scalar>membership{m}]<Ref>{pool-name}}</p>
<p>Thisis syntactically similar to the way vertices are assigned to</p>
<p>polygons. Each <VertexRef> entry can assign vertices from only one</p>
<p>vertexpool (but there may be many <VertexRef> entries per joint).</p>
<p>Indicesis a list of vertex numbers from the specied vertex pool, in</p>
<p>anarbitrary order.</p>
<p>Themembership scalar is optional.  If specified, it is a value</p>
<p>between0.0 and 1.0 that indicates the fraction of dominance this</p>
<p>jointhas over the vertices.  This is used to implement</p>
<p>soft-skinning,so that each vertex may have partial ownership in</p>
<p>severaljoints.</p>
<p>The<VertexRef> entry may also be given to ordinary <Group>nodes.</p>
<p>Inthis case, it treats the geometry as if it was parented under the</p>
<p>groupin the first place.  Non-total membership assignments are</p>
<p>meaningless.</p>
<p><Bundle>name{table-list}</p>
<Table>name{table-body}<p>Atable is a set of animated values for joints.  A tree of tables</p>
<p>withthe same structure as the corresponding tree of joints must be</p>
<p>definedfor each character to be animated.  Such a tree is placed</p>
<p>undera <Bundle> node, which provides a handle within Panda to the</p>
<p>treeas a whole.</p>
<p>Bundlesmay only contain tables; tables may contain more tables,</p>
<p>bundles,or any one of the following (<Scalar> entries are optional,</p>
<p>anddefault as shown):</p>
<p>&lt;S$Anim&gt;name{</p>
<p>​     <Scalar>fps{24}</p>
<p>​     <V>{values}</p>
<p>}</p>
<p>Thisis a table of scalar values, one per frame.  This may be</p>
<p>appliedto a morph slider, for instance.</p>
<p>&lt;Xfm$Anim&gt;name{</p>
<p>​     <Scalar>fps{24}</p>
<p>​     <Scalar>order{srpht}</p>
<p>​     <Scalar>contents{ijkabcrphxyz}</p>
<p>​     <V>{values}</p>
<p>}</p>
<p>Thisis a table of matrix transforms, one per frame, such as may</p>
<p>​    beapplied to a joint.  The &#8220;contents&#8221; string consists of asubset</p>
<p>​    ofthe letters &#8220;ijkabcrphxyz&#8221;, where each letter correspondsto a</p>
<p>columnof the table; <V> is a list of numbers of length(contents)</p>
<p>​    *num_frames.  Each letter of the contents string corresponds to a</p>
<p>typeof transformation:</p>
<p>​     i,j, k - scale in x, y, z directions, respectively</p>
<p>​     a,b, c - shear in xy, xz, and yz planes, respectively</p>
<p>​     r,p, h - rotate by roll, pitch, heading</p>
<p>​     x,y, z - translate in x, y, z directions</p>
<p>Thenet transformation matrix specified by each row of the table</p>
<p>​    isdefined as the net effect of each of the individual columns&#8217;</p>
<p>transform,according to the corresponding letter in the contents</p>
<p>string. The order the transforms are applied is defined by the</p>
<p>orderstring:</p>
<p>​     s      - all scale and shear transforms</p>
<p>​     r,p, h - individual rotate transforms</p>
<p>​     t      - all translation transforms</p>
<p>&lt;Xfm$Anim_S$&gt;name{</p>
<p>​     <Scalar>fps{24}</p>
<p>​     <Scalar>order{srpht}</p>
<p>​     &lt;S$Anim&gt;i{...}</p>
<p>​     &lt;S$Anim&gt;j{...}</p>
<p>​     ...</p>
<p>}</p>
<p>Thisis a variant on the &lt;Xfm$Anim&gt; entry, where each column of</p>
<p>thetable is entered as a separate &lt;S$Anim&gt; table.  This syntax</p>
<p>reflectsan attempt to simplify the description by not requiring</p>
<p>repetitionof values for columns that did not change value during</p>
<p>​    ananimation sequence.</p>
<p><VertexAnim>name{</p>
<p>​     <Scalar>width{table-width}</p>
<p>​     <Scalar>fps{24}</p>
<p>​     <V>{values}</p>
<p>}</p>
<p>Thisis a table of vertex positions, normals, texture coordinates,</p>
<p>​    orcolors.  These values will be subsituted at runtime for the</p>
<p>correspondingvalues in a <DynamicVertexPool>.  The name of the</p>
<p>tableshould be &#8220;coords&#8221;, &#8220;norms&#8221;, &#8220;texCoords&#8221;,or &#8220;colors&#8221;,</p>
<p>accordingto the type of values defined.  The number table-width</p>
<p>​    isthe number of floats in each row of the table.  In the case of</p>
<p>​    acoords or norms table, this must be 3 times the number of</p>
<p>verticesin the corresponding dynamic vertex pool.  (For texCoords</p>
<p>andcolors, this number must be 2 times and 4 times, respectively.)</p>
</div>
<div class="section" id="miscellaneous">
<span id="miscellaneous"></span><h3>MISCELLANEOUS<a class="headerlink" href="#miscellaneous" title="Permalink to this headline">¶</a></h3>
<p><File>{filename}</p>
<p>Thisincludes a copy of the referenced egg file at the current</p>
<p>point. This is usually placed under an <Instance> node, so that the</p>
<p>currenttransform will apply to the geometry in the external file.</p>
<p>Theextension &#8221;.egg&#8221; is implied if it is omitted.</p>
<p>Aswith texture filenames, the filename may be a relative path, in</p>
<p>whichcase the current egg file&#8217;s directory is searched first, and</p>
<p>thenthe model-path is searched.</p>
</div>
<div class="section" id="animationstructure">
<span id="animationstructure"></span><h3>ANIMATIONSTRUCTURE<a class="headerlink" href="#animationstructure" title="Permalink to this headline">¶</a></h3>
<p>Unanimatedmodels may be defined in egg files without much regard to</p>
<p>anyparticular structure, so long as named entries like VertexPools</p>
<p>andTextures appear before they are referenced.</p>
<p>However,a certain rigid structural convention must be followed in</p>
<p>orderto properly define an animated skeleton-morph model and its</p>
<p>associatedanimation data.</p>
<p>Thestructure for an animated model should resemble the following:</p>
<p><Group>CHARACTER_NAME{</p>
<p><Dart>{1}</p>
<p><Joint>JOINT_A{</p>
<p><Transform>{...}</p>
<p><VertexRef>{...}</p>
<p><Group>{<Polygon>...}</p>
<p><Joint>JOINT_B{</p>
<p>​     <Transform>{...}</p>
<p>​     <VertexRef>{...}</p>
<p>​     <Group>{<Polygon>...}</p>
<p>​    }</p>
<p><Joint>JOINT_C{</p>
<p>​     <Transform>{...}</p>
<p>​     <VertexRef>{...}</p>
<p>​     <Group>{<Polygon>...}</p>
<p>​    }</p>
<p>...</p>
<p>}</p>
<p>}</p>
<p>The<Dart> flag is necessary to indicate that this group begins an</p>
<p>animatedmodel description.  Without the <Dart> flag, joints will be</p>
<p>treatedas ordinary groups, and morphs will be ignored.</p>
<p>Inthe above, UPPERCASE NAMES represent an arbitrary name that you</p>
<p>maychoose.  The name of the enclosing group, CHARACTER_NAME, is</p>
<p>takenas the name of the animated model.  It should generally match</p>
<p>thebundle name in the associated animation tables.</p>
<p>Withinthe <Dart> group, you may define an arbitrary hierarchy of</p>
<p><Joint>entries.  There may be as many <Joint> entries as you like,</p>
<p>andthey may have any nesting complexity you like.  There may be</p>
<p>eitherone root <Joint>, or multiple roots.  However, you must</p>
<p>alwaysinclude at least one <Joint>, even if your animation consists</p>
<p>entirelyof morphs.</p>
<p>Polygonsmay be directly attached to joints by enclosing them within</p>
<p>the<Joint> group, perhaps with additional nesting <Group>entries,</p>
<p>asillustrated above.  This will result in the polygon&#8217;s vertices</p>
<p>beinghard-assigned to the joint it appears within.  Alternatively,</p>
<p>youdeclare the polygons elsewhere in the egg file, and use</p>
<p><VertexRef>entries within the <Joint> group to associate the</p>
<p>verticeswith the joints.  This is the more common approach, since</p>
<p>itallows for soft-assignment of vertices to multiple joints.</p>
<p>Itis not necessary for every joint to have vertices at all.  Every</p>
<p>jointshould include a transform entry, however, which defines the</p>
<p>initial,resting transform of the joint (but see also <DefaultPose>,</p>
<p>above). If a transform is omitted, the identity transform is</p>
<p>assumed.</p>
<p>Someof the vertex definitions may include morph entries, as</p>
<p>describedin MORPH DESCRIPTION ENTRIES, above.  These are meaningful</p>
<p>onlyfor vertices that are assigned, either implicitly or</p>
<p>explicitly,to at least one joint.</p>
<p>Youmay have multiple versions of a particular animated model&#8211;for</p>
<p>instance,multiple different LOD&#8217;s, or multiple different clothing</p>
<p>options. Normally each different version is stored in a different</p>
<p>eggfile, but it is also possible to include multiple versions</p>
<p>withinthe same egg file.  If the different versions are intended to</p>
<p>playthe same animations, they should all have the same</p>
<p>CHARACTER_NAME,and their joint hierarchies should exactly match in</p>
<p>structureand names.</p>
<p>Thestructure for an animation table should resemble the following:</p>
<Table>{<p><Bundle>CHARACTER_NAME{</p>
   <Table>"<skeleton>"{<p>​     <Table>JOINT_A{</p>
<p>​       &lt;Xfm$Anim_S$&gt;xform{</p>
<p>​         &lt;Char*&gt;order{sphrt}</p>
<p>​         <Scalar>fps{24}</p>
<p>​         &lt;S$Anim&gt;x{00101020...}</p>
<p>​         &lt;S$Anim&gt;y{00000...}</p>
<p>​         &lt;S$Anim&gt;z{2020202020...}</p>
<p>​       }</p>
<p>​       <Table>JOINT_B{</p>
<p>​         &lt;Xfm$Anim_S$&gt;xform{</p>
<p>​           &lt;Char*&gt;order{sphrt}</p>
<p>​           <Scalar>fps{24}</p>
<p>​           &lt;S$Anim&gt;x{...}</p>
<p>​           &lt;S$Anim&gt;y{...}</p>
<p>​           &lt;S$Anim&gt;z{...}</p>
<p>​         }</p>
<p>​       }</p>
<p>​       <Table>JOINT_C{</p>
<p>​         &lt;Xfm$Anim_S$&gt;xform{</p>
<p>​           &lt;Char*&gt;order{sphrt}</p>
<p>​           <Scalar>fps{24}</p>
<p>​           &lt;S$Anim&gt;x{...}</p>
<p>​           &lt;S$Anim&gt;y{...}</p>
<p>​           &lt;S$Anim&gt;z{...}</p>
<p>​         }</p>
<p>​       }</p>
<p>​     }</p>
<p>​    }</p>
   <Table>morph{<p>​     &lt;S$Anim&gt;MORPH_A{</p>
<p>​       <Scalar>fps{24}</p>
<p>​       <V>{0000.10.20.31...}</p>
<p>​     }</p>
<p>​     &lt;S$Anim&gt;MORPH_B{</p>
<p>​       <Scalar>fps{24}</p>
<p>​       <V>{...}</p>
<p>​     }</p>
<p>​     &lt;S$Anim&gt;MORPH_C{</p>
<p>​       <Scalar>fps{24}</p>
<p>​       <V>{...}</p>
<p>​     }</p>
<p>​    }</p>
<p>}</p>
<p>}</p>
<p>The<Bundle> entry begins an animation table description.  This</p>
<p>entrymust have at least one child: a <Table> named &#8220;<skeleton>&#8220;</p>
<p>(thisname is a literal keyword and must be present).  The children</p>
<p>ofthis <Table> entry should be a hierarchy of additional <Table></p>
<p>entries,one for each joint in the model.  The joint structure and</p>
<p>namesdefined by the <Table> hierarchy should exactly match the</p>
<p>jointstructure and names defined by the <Joint> hierarchy in the</p>
<p>correspondingmodel.</p>
<p>Each<Table> that corresponds to a joint should have one child, an</p>
<p>&lt;Xfm$Anim_S$&gt;entry named &#8220;xform&#8221; (this name is a literal keyword</p>
<p>andmust be present).  Within this entry, there is a series of up to</p>
<p>twelve&lt;S$Anim&gt; entries, each with a one-letter name like &#8220;x&#8221;,&#8221;y&#8221;,</p>
<p>or&#8221;z&#8221;, which define the per-frame x, y, z position of the</p>
<p>correspondingjoint.  There is one numeric entry for each frame, and</p>
<p>allframes represent the same length of time.  You can also define</p>
<p>rotation,scale, and shear.  See the full description of</p>
<p>&lt;Xfm$Anim_S$&gt;,above.</p>
<p>Withina particular animation bundle, all of the various components</p>
<p>throughoutthe various <Tables> should define the same number of</p>
<p>frames,with the exception that if any of them define exactly one</p>
<p>framevalue, that value is understood to be replicated the</p>
<p>appropriatenumber of times to match the number of frames defined by</p>
<p>othercomponents.</p>
<p>(Notethat you may alternatively define an animation table with an</p>
<p>&lt;Xfm$Anim&gt;entry, which defines all of the individual components in</p>
<p>onebig matrix instead of individually.  See the full description</p>
<p>above.)</p>
<p>Eachjoint defines its frame rate independently, with an &#8220;fps&#8221;</p>
<p>scalar. This determines the number of frames per second for the</p>
<p>framedata within this table.  Typically, all joints have the same</p>
<p>framerate, but it is possible for different joints to animate at</p>
<p>differentspeeds.</p>
<p>Eachjoint also defines the order in which its components should be</p>
<p>composedto determine the complete transform matrix, with an &#8220;order&#8221;</p>
<p>scalar. This is described in more detail above.</p>
<p>Ifany of the vertices in the model have morphs, the top-level</p>
 <Table>should also include a <Table> named "morph" (thisname is<p>alsoa literal keyword).  This table in turn contains a list of</p>
<p>&lt;S$Anim&gt;entries, one for each named morph description.  Each table</p>
<p>containsa list of numeric values, one per frame; as with the joint</p>
<p>data,there should be the same number of numeric values in all</p>
<p>tables,with the exception that just one value is understood to mean</p>
<p>holdthat value through the entire animation.</p>
<p>The&#8221;morph&#8221; table may be omitted if there are no morphs definedin</p>
<p>themodel.</p>
<p>Thereshould be a separate <Bundle> definition for each different</p>
<p>animation. The <Bundle> name should match the CHARACTER_NAME used</p>
<p>forthe model, above.  Typically each bundle is stored in a separate</p>
<p>eggfile, but it is also possible to store multiple different</p>
<p>animationbundles within the same egg file.  If you do this, you may</p>
<p>violatethe CHARACTER_NAME rule, and give each bundle a different</p>
<p>name;this will become the name of the animation in the Actor</p>
<p>interface.</p>
<p>Althoughanimations and models are typically stored in separate egg</p>
<p>files,it is possible to store them together in one large egg file.</p>
<p>TheActor interface will then make available all of the animations</p>
<p>itfinds within the egg file, by bundle name.</p>
</div>
</div>
<div class="section" id="howto-control-render-order">
<span id="howto-control-render-order"></span><h2>HOWTO CONTROL RENDER ORDER<a class="headerlink" href="#howto-control-render-order" title="Permalink to this headline">¶</a></h2>
<p>Inmost simple scenes, you can naively attach geometry to the scene</p>
<p>graphand let Panda decide the order in which objects should be</p>
<p>rendered. Generally, it will do a good enough job, but there are</p>
<p>occasionsin which it is necessary to step in and take control of the</p>
<p>process.</p>
<p>Todo this well, you need to understand the implications of render</p>
<p>order. In a typical OpenGL- or DirectX-style Z-buffered system, the</p>
<p>orderin which primitives are sent to the graphics hardware is</p>
<p>theoreticallyunimportant, but in practice there are many important</p>
<p>reasonsfor rendering one object before another.</p>
<p>Firstly,state sorting is one important optimization.  This means</p>
<p>choosingto render things that have similar state (texture, color,</p>
<p>etc.)all at the same time, to minimize the number of times the</p>
<p>graphicshardware has to be told to change state in a particular</p>
<p>frame. This sort of optimization is particularly important for very</p>
<p>high-endgraphics hardware, which achieves its advertised theoretical</p>
<p>polygonthroughput only in the absence of any state changes; for many</p>
<p>suchadvanced cards, each state change request will completely flush</p>
<p>theregister cache and force a restart of the pipeline.</p>
<p>Secondly,some hardware has a different optimization requirement, and</p>
<p>maybenefit from drawing nearer things before farther things, so that</p>
<p>theZ-buffer algorithm can effectively short-circuit some of the</p>
<p>advancedshading features in the graphics card for pixels that would</p>
<p>beobscured anyway.  This sort of hardware will draw things fastest</p>
<p>whenthe scene is sorted in order from the nearest object to the</p>
<p>farthestobject, or &#8220;front-to-back&#8221; ordering.</p>
<p>Finally,regardless of the rendering optimizations described above, a</p>
<p>particularsorting order is required to render transparency properly</p>
<p>(inthe absence of the specialized transparency support that only a</p>
<p>fewgraphics cards provide).  Transparent and semitransparent objects</p>
<p>arenormally rendered by blending their semitransparent parts with</p>
<p>whathas already been drawn to the framebuffer, which means that it is</p>
<p>importantthat everything that will appear behind a semitransparent</p>
<p>objectmust have already been drawn before the semitransparent parts</p>
<p>ofthe occluding object is drawn.  This implies that all</p>
<p>semitransparentobjects must be drawn in order from farthest away to</p>
<p>nearest,or in &#8220;back-to-front&#8221; ordering, and furthermore that the</p>
<p>opaqueobjects should all be drawn before any of the semitransparent</p>
<p>objects.</p>
<p>Pandaachieves these sometimes conflicting sorting requirements</p>
<p>throughthe use of bins.</p>
<div class="section" id="cullbins">
<span id="cullbins"></span><h3>CULLBINS<a class="headerlink" href="#cullbins" title="Permalink to this headline">¶</a></h3>
<p>TheCullBinManager is a global object that maintains a list of all of</p>
<p>thecull bins in the world, and their properties.  Initially, there</p>
<p>arefive default bins, and they will be rendered in the following</p>
<p>order:</p>
<p>BinName        Sort  Type</p>
<hr class="docutils" />
<p>&#8220;background&#8221;    10   BT_fixed</p>
<p>&#8220;opaque&#8221;        20   BT_state_sorted</p>
<p>&#8220;transparent&#8221;   30   BT_back_to_front</p>
<p>&#8220;fixed&#8221;         40   BT_fixed</p>
<p>&#8220;unsorted&#8221;      50   BT_unsorted</p>
<p>WhenPanda traverses the scene graph each frame for rendering, it</p>
<p>assignseach Geom it encounters into one of the bins defined in the</p>
<p>CullBinManager. (The above lists only the default bins.  Additional</p>
<p>binsmay be created as needed, using either the</p>
<p>CullBinManager::add_bin()method, or the Config.prc &#8220;cull-bin&#8221;</p>
<p>variable.)</p>
<p>Youmay assign a node or nodes to an explicit bin using the</p>
<p>NodePath::set_bin()interface.  set_bin() requires two parameters, the</p>
<p>binname and an integer sort parameter; the sort parameter is only</p>
<p>meaningfulif the bin type is BT_fixed (more on this below), but it</p>
<p>mustalways be specified regardless.</p>
<p>Ifa node is not explicitly assigned to a particular bin, then Panda</p>
<p>willassign it into either the &#8220;opaque&#8221; or the &#8220;transparent&#8221;bin,</p>
<p>accordingto whether it has transparency enabled or not.  (Note that</p>
<p>thereverse is not true: explicitly assigning an object into the</p>
<p>&#8220;transparent&#8221;bin does not automatically enable transparency for the</p>
<p>object.)</p>
<p>Whenthe entire scene has been traversed and all objects have been</p>
<p>assignedto bins, then the bins are rendered in order according to</p>
<p>theirsort parameter.  Within each bin, the contents are sorted</p>
<p>accordingto the bin type.</p>
<p>Thefollowing bin types may be specified:</p>
<p>BT_fixed</p>
<p>Renderall of the objects in the bin in a fixed order specified by</p>
<p>theuser.  This is according to the second parameter of the</p>
<p>NodePath::set_bin()method; objects with a lower value are drawn</p>
<p>first.</p>
<p>BT_state_sorted</p>
<p>Collectstogether objects that share similar state and renders</p>
<p>themtogether, in an attempt to minimize state transitions in the</p>
<p>scene.</p>
<p>BT_back_to_front</p>
<p>Sortseach Geom according to the center of its bounding volume, in</p>
<p>lineardistance from the camera plane, so that farther objects are</p>
<p>drawnfirst.  That is, in Panda&#8217;s default right-handed Z-up</p>
<p>coordinatesystem, objects with large positive Y are drawn before</p>
<p>objectswith smaller positive Y.</p>
<p>BT_front_to_back</p>
<p>Thereverse of back_to_front, this sorts so that nearer objects</p>
<p>aredrawn first.</p>
<p>BT_unsorted</p>
<p>Objectsare drawn in the order in which they appear in the scene</p>
<p>graph,in a depth-first traversal from top to bottom and then from</p>
<p>leftto right.</p>
</div>
</div>
<div class="section" id="howto-make-multipart-actor">
<span id="howto-make-multipart-actor"></span><h2>Howto make multipart actor<a class="headerlink" href="#howto-make-multipart-actor" title="Permalink to this headline">¶</a></h2>
<div class="section" id="multipartactors-vs-half-body-animation">
<span id="multipartactors-vs-half-body-animation"></span><h3>MULTIPARTACTORS vs. HALF-BODY ANIMATION<a class="headerlink" href="#multipartactors-vs-half-body-animation" title="Permalink to this headline">¶</a></h3>
<p>Sometimesyou want to be able to play two different animations on the</p>
<p>sameActor at once.  Panda does have support for blending two</p>
<p>animationson the whole Actor simultaneously, but what if you want to</p>
<p>playone animation (say, a walk cycle) on the legs while a completely</p>
<p>differentanimation (say, a shoot animation) is playing on the torso?</p>
<p>AlthoughPanda doesn&#8217;t currently have support for playing two</p>
<p>differentanimations on different parts of the same actor at once</p>
<p>(half-bodyanimation), it does support loading up two completely</p>
<p>differentmodels into one actor (multipart actors), which can be used</p>
<p>toachieve the same effect, albeit with a bit more setup effort.</p>
<p>Multipartactors are more powerful than half-body animations, since</p>
<p>youcan completely mix-and-match the pieces with parts from other</p>
<p>characters:for instance, you can swap out short legs for long legs to</p>
<p>makeyour character taller.  On the other hand, multipart actors are</p>
<p>alsomore limited in that there cannot be any polygons that straddle</p>
<p>theconnecting joint between the two parts.</p>
</div>
<div class="section" id="broadoverview">
<span id="broadoverview"></span><h3>BROADOVERVIEW<a class="headerlink" href="#broadoverview" title="Permalink to this headline">¶</a></h3>
<p>Whatyou have to do is split your character into two completely</p>
<p>differentmodels: the legs and the torso.  You don&#8217;t have to do this</p>
<p>inthe modeling package; you should be able to do it in the conversion</p>
<p>process. The converter needs to be told to get out the entire</p>
<p>skeleton,but just a subset of the geometry.  Maya2egg, for instance,</p>
<p>willdo this with the -subset command-line parameter.</p>
<p>Then,in a nutshell, you load up a multipart actor with the legs and</p>
<p>thetorso as separate parts, and you can play the same animation on</p>
<p>bothparts, or you can use the per-part interface to play a different</p>
<p>animationon each part.</p>
</div>
<div class="section" id="moredetails">
<span id="moredetails"></span><h3>MOREDETAILS<a class="headerlink" href="#moredetails" title="Permalink to this headline">¶</a></h3>
<p>Thatnutshell oversimplifies things only a little bit.  Unless your</p>
<p>differentanimations are very similar to each other, you will have</p>
<p>issueskeeping the different parts from animating in different</p>
<p>directions. To solve this, you need to parent them together properly,</p>
<p>sothat the torso is parented to the hips.  This means exposing the</p>
<p>hipjoint in the legs model, and subtracting the hip joint animation</p>
<p>fromthe torso model using egg-topstrip (because it will pick it up</p>
<p>againwhen it gets stacked up on the hips).  Also, you should strongly</p>
<p>consideregg-optchar to remove the unused joints from each part&#8217;s</p>
<p>skeleton,although this step is just an optimization.</p>
<p>Unfortunately,all this only works if your character has no polygons</p>
<p>thatstraddle the connecting joint between the hips and the torso.  If</p>
<p>itdoes, you may have to find a clever place to draw the line between</p>
<p>them(under a shirt?) so that the pieces can animate in different</p>
<p>directionswithout visible artifacts.  If that can&#8217;t be done, then the</p>
<p>onlysolution is to add true half-body animation support to Panda. :)</p>
</div>
<div class="section" id="nuts-and-bolts">
<span id="nuts-and-bolts"></span><h3>NUTS AND BOLTS<a class="headerlink" href="#nuts-and-bolts" title="Permalink to this headline">¶</a></h3>
<p>You need to parent the two parts together in Panda.  The complete</p>
<p>processis this (of course, you&#8217;ll need to flesh out the details of</p>
<p>themaya2egg command line according to the needs of your model, and</p>
<p>insertyour own filenames and joint names where appropriate):</p>
<p>(1)Extract out the model into two separate files, legs and torso.</p>
<p>Extractthe animation out twice too, even though both copies will</p>
<p>​    bethe same, just so it can conveniently exist in two different</p>
<p>eggfiles, one for the legs and one for the torso.</p>
<p>maya2egg-subset legs_group -a model -cn legs -o legs-model.egg myFile.mb</p>
<p>maya2egg-a chan -cn legs -o legs-walk.egg myFile.mb</p>
<p>maya2egg-subset torso_group -a model -cn torso -o torso-model.egg myFile.mb</p>
<p>maya2egg-a chan -cn torso -o torso-walk.egg myFile.mb</p>
<p>Notethat I use the -cn option to give the legs and torso pieces</p>
<p>differentcharacter names.  It helps out Panda to know which</p>
<p>animationsare intended to be played with which models, and the</p>
<p>charactername serves this purpose&#8211;this way I can now just type:</p>
<p>pviewlegs-model.egg legs-walk.egg torso-model.egg torso-walk.eggPanda willbind up the</p>
<p>appropriateanimations to their associated</p>
<p>modelsautomatically, and I should see my character walking</p>
<p>normally. We could skip straight to step (5) now, but the</p>
<p>characterisn&#8217;t stacked up yet, and he&#8217;s only sticking together</p>
<p>nowbecause we&#8217;re playing the walk animation on both parts at the</p>
<p>sametime&#8211;if we want to play different animations on different</p>
<p>parts,we have to stack them.</p>
<p>(2)Expose the hip joint on the legs:</p>
<p>egg-optchar-d opt -expose hip_joint legs-model.egg legs-walk.egg</p>
<p>(3)Strip out the hip joint animation from the torso and egg-optchar</p>
<p>​    itto remove the leg joints:</p>
<p>egg-topstrip-d strip -t hip_joint torso-model.egg torso-walk.egg</p>
<p>egg-optchar-d opt strip/torso-model.egg strip/torso-walk.egg</p>
<p>(4)Bamify everything.</p>
<p>egg2bam-o legs-model.bam opt/legs-model.egg</p>
<p>egg2bam-o legs-walk.bam opt/legs-walk.egg</p>
<p>egg2bam-o torso-model.bam opt/torso-model.egg</p>
<p>egg2bam-o torso-walk.bam opt/torso-walk.egg</p>
<p>(5)Create a multipart character in Panda.  This means loading up the</p>
<p>torsomodel and parenting it, in toto, to the hip joint of the</p>
<p>legs. But the Actor interface handles this for you:</p>
<p>fromdirect.actorimportActor</p>
<p>a=Actor.Actor(</p>
<p>​     #part dictionary</p>
<p>​     {&#8216;torso&#8217;:&#8217;torso-model.bam&#8217;,</p>
<p>​      &#8216;legs&#8217;:&#8217;legs-model.bam&#8217;,</p>
<p>​    },</p>
<p>​     #anim dictionary</p>
<p>​     {&#8216;torso&#8217;:{&#8216;walk&#8217;:&#8217;torso-walk.bam&#8217;},</p>
<p>​      &#8216;legs&#8217;:{&#8216;walk&#8217;:&#8217;legs-walk.bam&#8217;},</p>
<p>​    })</p>
<p>#Tell the Actor how to stack the pieces.</p>
<p>a.attach(&#8216;torso&#8217;,&#8217;legs&#8217;,&#8217;hip_joint&#8217;)</p>
<p>(6)You can now play animations on the whole actor, or on only part ofit:</p>
<p>a.loop(&#8216;walk&#8217;)</p>
<p>a.stop()</p>
<p>a.loop(&#8216;walk&#8217;,partName=&#8217;legs&#8217;)</p>
</div>
</div>
<div class="section" id="multigenmodel-flags">
<span id="multigenmodel-flags"></span><h2>MULTIGENMODEL FLAGS<a class="headerlink" href="#multigenmodel-flags" title="Permalink to this headline">¶</a></h2>
<p>Thisdocument describes the different kinds of model flags one can placein</p>
<p>thecomment field of MultiGen group beads.  The general format for amodel</p>
<p>flagis:</p>
<p>​                      <egg>{ <FLAGNAME> {value} }</p>
<p>Themost up-to-date version of this document can be found in:</p>
<p>​                  $PANDA/src/doc/howto.MultiGenModelFlags</p>
<hr class="docutils" />
<p>​                                <strong>QUICKREF</strong></p>
<hr class="docutils" />
<p>​           FLAG                               DESCRIPTION</p>
<hr class="docutils" />
<p><egg>{ <Model>      {1} }          Handle to show/hide, color, etc.a chunk</p>
<p><egg>{ <DCS>        {1} }          Handle to move, rotate, scale achunk</p>
<p><egg>{ <ObjectType> {barrier} }    Invisible collision surface</p>
<p><egg>{ <ObjectType> {trigger} }    Invisible trigger polygon</p>
<p><egg>{ <ObjectType> {floor} }      Collides with vertical ray</p>
<p>​                                   (usedto specify avatar height and zone)</p>
<p><egg>{ <ObjectType> {sphere} }              Invisible spherecollision surface</p>
<p><egg>{ <ObjectType> {trigger-sphere} }      Invisible spherecollision surface</p>
<p><egg>{ <ObjectType> {camera-collide} }              Invisiblecollision surface for camera</p>
<p><egg>{ <ObjectType> {camera-collide-sphere} }       Invisiblecollision surface for camera</p>
<p><egg>{ <ObjectType> {camera-barrier} }      Invisible collisionsurface for camera and colliders</p>
<p><egg>{ <ObjectType> {camera-barrier-sphere} }     Invisible spherecollision surface for camera and colliders</p>
<p><egg>{ <ObjectType> {backstage} }  Modeling reference object</p>
<p><egg>{ <Decal>      {1} }          Decal the node below to me</p>
<p>​                                   (likea window on a wall)</p>
<p><egg>{ <Scalar> fps { # } }        Set rate of animation for apfSequence</p>
<hr class="docutils" />
<p>​                                 <strong>DETAILS</strong></p>
<hr class="docutils" />
<p>Theplayer uses several different types of model flags: HANDLES,BEHAVIORS,</p>
<p>andPROPERTIES.  The following sections give examples of some of the most</p>
<p>commonflag/value pairs and describes what they are used for.</p>
<div class="section" id="handles">
<span id="handles"></span><h3>HANDLES<a class="headerlink" href="#handles" title="Permalink to this headline">¶</a></h3>
<p>Theseflags give the programmers handles which they can use to</p>
<p>show/hide,move around, control the texture, etc. of selected segments</p>
<p>(chunks)of the model.  The handle is the name of the object bead in</p>
<p>whichone places the flag (so names like red-hut are more useful than</p>
<p>nameslike o34).</p>
<p><egg>{ <Model> {1} }</p>
<p>Usedto show/hide, change the color, or change the collision properties</p>
<p>ofa chunk.</p>
<p><egg>{ <DCS> {1} }</p>
<p>Usedto move, rotate, or scale a chunk of the model.  Also can be used</p>
<p>(likethe <Model> flag) to show/hide, change the color, and changethe</p>
<p>collisionproperties of a chunk.</p>
</div>
<div class="section" id="behaviors">
<span id="behaviors"></span><h3>BEHAVIORS<a class="headerlink" href="#behaviors" title="Permalink to this headline">¶</a></h3>
<p>Theseflags are used to control collision properties, visibility and</p>
<p>behaviorof selected chunks.  An &#8220;X&#8221; in the associated column means:</p>
<p>​     VISIBLE the object can be seen (see NOTE below for invisible objects)</p>
<p>​     SOLID   avatars can not pass through the object</p>
<p>​     EVENT   an event is thrown whenever an avatar collides with the object</p>
<p>​                                      VISIBLE     SOLID       EVENT</p>
<p>​                                      &#8212;&#8212;-    &#8212;&#8212;-     &#8212;&#8212;-</p>
<p><egg>{ <ObjectType> {barrier} }                      X           X</p>
<p><egg>{ <ObjectType> {trigger} }                                  X</p>
<p><egg>{ <ObjectType> {backstage} }</p>
<p><strong>Descriptions</strong></p>
<p>​     - BARRIERS are invisible objects that block the avatars.  Use these</p>
<p>​        tofunnel avatars through doorways, keep them from falling off</p>
<p>​        bridges,and so on.</p>
<p>​     - TRIGGERS can be used to signal when avatars have entered a certain</p>
<p>​        areaof the model.  One could place a trigger polygon in front of</p>
<p>​        adoor, for example, so the player can tell when the avatar has</p>
<p>​        movedthrough the door.</p>
<p>​     - BACKSTAGE objects are not translated over to the player.  Modelers</p>
<p>​        shoulduse this flag on reference objects that they include to help</p>
<p>​        inthe modeling task (such as scale references)</p>
<p><strong>IMPORTANTNOTE</strong></p>
<p>Itis not necessary, and in fact some cases it will actually cause</p>
<p>problemsif you set the transparency value for the invisible objects</p>
<p>above(barrier, trigger, eye-trigger) to 0.0.  These objects will</p>
<p>automaticallybe invisible in the player if they have been flagged as</p>
<p>oneof these three invisible types.  If you wish to make it clear in</p>
<p>MultiGenthat these objects are invisible objects, set the transparency</p>
<p>valueto some intermediate level (0.5).  Again, do not set the</p>
<p>transparencyvalue to 0.0.</p>
</div>
<div class="section" id="properties">
<span id="properties"></span><h3>PROPERTIES<a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h3>
<p>Theseare used to control properties of selected chunks.</p>
<p><egg>{ <Scalar> fps { frame-rate } }</p>
<p>Thisspecifies the rate of animation for a pfSequence node</p>
<hr class="docutils" />
<p>​                                  <strong>NOTES</strong></p>
<hr class="docutils" />
<p>1)Combinations</p>
<p>MultipleFlag/value pairs can be combined within an single <egg> field.</p>
<p>Forexample:</p>
<p><egg>{ <Model> {1}</p>
<p>​          <ObjectType>{barrier} }</p>
<p>Generally,the <Model> flag can be combined with most other flags</p>
<p>(exceptDCS).  Each bead, however, can only have <em>one</em> <ObjectType>flag.</p>
<p>2)Newlines, spaces, and case (usually) do not matter.  This above entry</p>
<p>couldalso be written as:</p>
<p><egg>{<model>{1}<objecttype>{barrier}}</p>
<p>​</p>
<p>3)Where to place the flags</p>
<p>Allmodel flags except <Normal> flags are generally placed in the</p>
<p>topmostgroup bead of the geometry to which the flag applies.</p>
<p>​        GROUP &lt;- place flags here, except <Normal></p>
<p>​          |</p>
<p>​          -&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;</p>
<p>​          |           |            |</p>
<p>​       OBJECT1     OBJECT2      OBJECT3 .....</p>
<p>​          |           |            |</p>
<p>​       polygons    polygons     polygons  &lt;- place <Normal> flag here</p>
<p>Flagscan also be placed in object beads, though for consistency sake</p>
<p>itsbetter to place them in the group beads.</p>
<p>4)Flags at different levels in the model</p>
<p>Flagsin lower level beads generally override flags in upper level</p>
<p>beads.</p>
<p>5)For more detailed information see $PANDA/src/doc/eggSyntax.txt.</p>
</div>
</div>
<div class="section" id="multi-texturing-in-maya">
<span id="multi-texturing-in-maya"></span><h2>Multi-Texturing in Maya<a class="headerlink" href="#multi-texturing-in-maya" title="Permalink to this headline">¶</a></h2>
<p>A good rule of thumb is to create yourMulti-Layered shader first to get an idea of what kind of blendmodeyou want. You can do that by using Maya&#8217;s kLayeredShader.</p>
<p>Following blendmode from Maya is supporteddirectly in Panda.</p>
<p>&#8220;Multiply&#8221; =&gt; &#8220;Modulate&#8221;</p>
<p>&#8220;Over&#8221; =&gt; &#8220;Decal&#8221;</p>
<p>&#8220;Add&#8221; =&gt; &#8220;Add&#8221;</p>
<p>More blendmodes will be supported very soon. Youshould be able to pview this change if you restart Maya from the&#8221;runmaya.bat&#8221; (or however you restart maya).</p>
<p>Once the shader is setup, you should create thetexture coordinates or uvsets for your multitexture. Make sure, theuvset name matches the shader names that you made</p>
<p>in the kLayeredShader. For Example, if the twoshaders (not the texure file name) in your kLayeredShader are called&#8221;base&#8221; and &#8220;top&#8221;, then your geometry (that willhave</p>
<p>the layeresShader) will have two uvsets called&#8221;base&#8221; and &#8220;top&#8221;.</p>
<p>After this you will link the uvsets to theappropriate shaders.</p>
<p>A reminder note: by default the alpha channel ofthe texture on the bottom is dropped in the conversion. If you wantto retain the alpha channel of your texture,</p>
<p>please make a connection to the alpha channel inMaya when setting up the shader (alpha on the layerShader will behighlighted in yellow).</p>
</div>
<div class="section" id="config">
<span id="config"></span><h2>Config<a class="headerlink" href="#config" title="Permalink to this headline">¶</a></h2>
<p>This document describes the use of the Panda&#8217;sConfig.prc</p>
<p>configuration files and the runtime subsystem thatextracts values</p>
<p>from these files, defined in dtool/src/prc.</p>
<p>The Config.prc files are used for runtimeconfiguration only, and are</p>
<p>not related to the Config.pp files, which controlcompile-time</p>
<p>configuration.  If you are looking fordocumentation on the Config.pp</p>
<p>files, see howto.use_ppremake.txt, andppremake-*.txt, in this</p>
<p>directory.</p>
<div class="section" id="using-the-prc-files">
<span id="using-the-prc-files"></span><h3>Using the prc files<a class="headerlink" href="#using-the-prc-files" title="Permalink to this headline">¶</a></h3>
<p>In its default mode, when Panda starts up it willsearch in the</p>
<p>install/etc directory (or in the directory namedby the environment</p>
<p>variable PRC_DIR if it is set) for all files named*.prc (that is, any</p>
<p>files with an extension of &#8220;prc&#8221;) andread each of them for runtime</p>
<p>configuration.  (It is possible to change thisdefault behavior; see</p>
<p>COMPILE-TIME OPTIONS FOR FINDING PRC FILES,below.)</p>
<p>All of the prc files are loaded in alphabeticalorder, so that the</p>
<p>files that have alphabetically later names areloaded last.  Since</p>
<p>variables defined in an later file may shadowvariables defined in an</p>
<p>earlier file, this means that filenames towardsthe end of the</p>
<p>alphabet have the most precedence.</p>
<p>Panda by default installs a handful of system prcfiles into the</p>
<p>install/etc directory.  These files have namesbeginning with digits,</p>
<p>like 20_panda.prc and 40_direct.prc, so that theywill be loaded in a</p>
<p>particular order.  If you create your own prc filein this directory,</p>
<p>we recommend that you begin its filename withletters, so that it will</p>
<p>sort to the bottom of the list and will thereforeoverride any of the</p>
<p>default variables defined in the system prc files.</p>
<p>Within a particular prc file, you may define anynumber of</p>
<p>configuration variables and their associatedvalue.  Each definition</p>
<p>must appear one per line, with at least one spaceseparating the</p>
<p>variable and itsdefinition, e.g.:</p>
<p>load-display pandagl</p>
<p>This specifies that the variable &#8220;load-display&#8221;should have the value</p>
<p>&#8220;pandagl&#8221;.</p>
<p>Comments may also appear in the file; they areintroduced by a leading</p>
<p>hash mark (#).  A comment may be on a line byitself, or it may be on</p>
<p>the same line following a variable definition; ifit is on the same</p>
<p>line as a variable definition, the hash mark mustbe preceded by at</p>
<p>least one space to separate it from thedefinition.</p>
<p>The legal values that you may specify for anyparticular variable</p>
<p>depends on the variable.  The complete list ofavailable variables and</p>
<p>the valid values for each is not documented here(a list of the most</p>
<p>commonly modified variables appears in anotherdocument, but also see</p>
<p>cvMgr.listVariables(), below).</p>
<p>Many variables accept any string value (such asload-display, above);</p>
<p>many others, such as aspect-ratio, expect anumeric value.</p>
<p>A large number of variables expect a simpleboolean true/false value.</p>
<p>You may observe the Python convention of using 0vs. 1 to represent</p>
<p>false vs. true; or you may literally type &#8220;false&#8221;or &#8220;true&#8221;, or just</p>
<p>&#8220;f&#8221; and &#8220;t&#8221;.  For historicalreasons, Panda also recognizes the Scheme</p>
<p>convention of &#8220;#f&#8221; and &#8220;#t&#8221;.</p>
<p>Most variables only accept one value at a time. If there are two</p>
<p>different definitions for a given variable in thesame file, the</p>
<p>topmost definition applies.  If there are twodifferent definitions in</p>
<p>two different files, the definition given in thefile loaded later</p>
<p>applies.</p>
<p>However, some variables accept multiple values. This is particularly</p>
<p>common for variables that name search directories,like model-path.</p>
<p>In the case of this kind of variable, alldefinitions given for the</p>
<p>variable are taken together; it is possible toextend the definition</p>
<p>by adding another prc file, but you cannot removeany value defined in</p>
<p>a previously-loaded prc file.</p>
</div>
<div class="section" id="defining-config-variables">
<span id="defining-config-variables"></span><h3>Defining config variables<a class="headerlink" href="#defining-config-variables" title="Permalink to this headline">¶</a></h3>
<p>New config variables may be defined on-the-fly ineither C++ or Python</p>
<p>code.  To do this, create an instance of one ofthe following classes:</p>
<p>ConfigVariableString</p>
<p>ConfigVariableBool</p>
<p>ConfigVariableInt</p>
<p>ConfigVariableDouble</p>
<p>ConfigVariableFilename</p>
<p>ConfigVariableEnum (C++ only)</p>
<p>ConfigVariableList</p>
<p>ConfigVariableSearchPath</p>
<p>These each define a config variable of thecorresponding type.  For</p>
<p>instance, a ConfigVariableInt defines a variablewhose value must</p>
<p>always be an integer value.  The most commonvariable types are the</p>
<p>top four, which are self-explanatory; theremaining four are special</p>
<p>types:</p>
<p>ConfigVariableFilename -</p>
<p>This is a convenience class which behaves verymuch like a</p>
<p>ConfigVariableString, except that itautomatically converts from</p>
<p>OS-specific filenames that may be given in theprc file to</p>
<p>Panda-specific filenames, and it alsoautomatically expands</p>
<p>environment variable references, so that theuser may name a file</p>
<p>based on the value of an environment variable</p>
<p>(e.g. $PANDAMODELS/file.egg).</p>
<p>ConfigVariableEnum -</p>
<p>This is a special template class available inC++ only.  It provides</p>
<p>a convenient way to define a variable that mayaccept any of a</p>
<p>handful of different values, each of which isdefined by a keyword.</p>
<p>For instance, the text-encoding variable may beset to any of</p>
<p>&#8220;iso8859&#8221;, &#8220;utf8&#8221;, or&#8221;unicode&#8221;, which correspond to</p>
<p>TextEncoder::E_iso8859, E_utf8, and E_unicode,respectively.</p>
<p>The ConfigVariableEnum class relies on a havingsensible pair of</p>
<p>functionsdefined for operator &lt;&lt; (ostream) and operator &gt;&gt;(istream)</p>
<p>for the enumerated type.  These two functionsshould</p>
<p>reverse each other, so that the output operatorgenerates a keyword</p>
<p>for each value of the enumerated type, and theinput operator</p>
<p>recognizes each of the keywords generated by theoutput operator.</p>
<p>This is a template class.  It is templated onits enumerated type,</p>
<p>e.g. ConfigVariableEnum&lt;TextEncoder::Encoding&gt;.</p>
<p>ConfigVariableList -</p>
<p>This class defines a special config variablethat records all of its</p>
<p>definitions appearing in all prc files andretrieves them as a list,</p>
<p>instead of a standard config variable thatreturns only the topmost</p>
<p>definition.  (See &#8220;some variables acceptmultiple values&#8221;, above.)</p>
<p>Unlike the other kinds of config variables, aConfigVariableList is</p>
<p>read-only; it can be modified only by loadingadditional prc files,</p>
<p>rather than directly setting its value.  Also,its constructor lacks</p>
<p>a default_value parameter, since there is nodefault value (if the</p>
<p>variable is not defined in any prc file, itsimply returns an empty</p>
<p>list).</p>
<p>ConfigVariableSearchPath -</p>
<p>This class is very similar to aConfigVariableList, above, except</p>
<p>that it is intended specifically to representthe multiple</p>
<p>directories of a search path.  In general, a</p>
<p>ConfigVariableSearchPath variable can be used inplace of a</p>
<p>DSearchPath variable.</p>
<p>Unlike ConfigVariableList, instances of thisvariable can be locally</p>
<p>modified by appending or prepending additionaldirectory names.</p>
<p>In general, each of the constructors to the aboveclasses accepts the</p>
<p>following parameters:</p>
<p>(name, default_value, description = &#8220;&#8221;,flags = 0)</p>
<p>The default_value parameter should be of the sametype as the variable</p>
<p>itself; for instance, the default_value for aConfigVariableBool must</p>
<p>be either true or false.  The ConfigVariableListand ConfigVariableSearchPath constructors do not have a default_value</p>
<p>parameter.</p>
<p>The description should be a sentence or twodescribing the purpose of</p>
<p>the variable and the effects of setting it.  Itwill be reported with</p>
<p>variable.getDescription() orConfigVariableManager.listVariables();</p>
<p>see QUERYING CONFIG VARIABLES, below.</p>
<p>The flags variable is usually set to 0, but it maybe an integer trust</p>
<p>level and/or the union of any of the values in theenumerated type</p>
<p>ConfigFlags::VariableFlags.  For the most part,this is used to</p>
<p>restrict the variable from being set by unsignedprc files.  See</p>
<p>SIGNED PRC FILES, below.</p>
<p>Once you have created a config variable of theappropriate type, you</p>
<p>may generally treat it directly as a simplevariable of that type.</p>
<p>This works in both C++ and in Python.  Forinstance, you may write</p>
<p>code such as this:</p>
<p>ConfigVariableInt foo_level(&#8220;foo-level&#8221;,-1, &#8220;The level of foo&#8221;);</p>
<p>if (foo_level &lt; 0) {</p>
<p>cerr &lt;&lt; &#8220;You didn&#8217;t specify a validfoo_level!\n&#8221;;</p>
<p>} else {</p>
<p>// Four snarfs for every foo.</p>
<p>int snarf_level = 4 * foo_level;</p>
<p>}</p>
<p>In rare cases, you may find that the implicittypecast operators</p>
<p>aren&#8217;t resolved properly by the compiler; if thishappens, you can use</p>
<p>variable.get_value() to retrieve the variable&#8217;svalue explicitly.</p>
</div>
<div class="section" id="directly-assigning-config-variables">
<span id="directly-assigning-config-variables"></span><h3>Directly assigning config variables<a class="headerlink" href="#directly-assigning-config-variables" title="Permalink to this headline">¶</a></h3>
<p>In general, config variables can be directlyassigned values</p>
<p>appropriate to their type, as if they wereordinary variables.  In</p>
<p>C++, the assignment operator is overloaded toperform this function,</p>
<p>e.g.:</p>
<p>foo_level = 5;</p>
<p>In Python, this syntax is not possible&#8211;theassignment operator in</p>
<p>Python completely replaces the value of theassigned symbol and cannot</p>
<p>be overloaded.  So the above statement in Pythonwould replace</p>
<p>foo_level with an actual integer of the value 5. In many cases, this</p>
<p>is close enough to what you intended anyway, butif you want to keep</p>
<p>the original functionality of the config variable(e.g. so you can</p>
<p>restore it to its original value later), you needto use the</p>
<p>set_value() method instead, like this:</p>
<p>fooLevel.setValue(5)</p>
<p>When you assign a variable locally, the newdefinition shadows all prc</p>
<p>files that have been read or will ever be read,until you clear your</p>
<p>definition.  To restore a variable to its originalvalue as defined by</p>
<p>the topmost prc file, use clear_local_value():</p>
<p>fooLevel.clearLocalValue()</p>
<p>This interface for assigning config variables isprimarily intended</p>
<p>for the convenience of developing an applicationinteractively; it is</p>
<p>sometimes useful to change the value of a variableon the fly.</p>
</div>
<div class="section" id="querying-config-variables">
<span id="querying-config-variables"></span><h3>Querying config variables<a class="headerlink" href="#querying-config-variables" title="Permalink to this headline">¶</a></h3>
<p>There are several mechanisms for finding out thevalues of individual</p>
<p>config variables, as well as for finding thecomplete list of</p>
<p>available config variables.</p>
<p>In particular, one easy way to query an existingconfig variable&#8217;s</p>
<p>value is simply to create a new instance of thatvariable, e.g.:</p>
<p>print ConfigVariableInt(&#8220;foo-level&#8221;)</p>
<p>The default value and comment are optional ifanother instance of the</p>
<p>same config variable has previously been created,supplying these</p>
<p>parameters.  However, it is an error if noinstance of a particular</p>
<p>config variable specifies a default value.  It isalso an error (but</p>
<p>it is treated as a warning) if two differentinstances of a variable</p>
<p>specify different default values.</p>
<p>(Note that, although it is convenient to create anew instance of the</p>
<p>variable in order to query or modify its valueinteractively, we</p>
<p>recommend that all the references to a particularvariable in code</p>
<p>should use the same instance wherever possible. This minimizes the</p>
<p>potential confusion about which instance shoulddefine the variable&#8217;s</p>
<p>default value and/or description, and reduceschance of conflicts</p>
<p>should two such instances differ.)</p>
<p>If you don&#8217;t know the type of the variable, youcan also simply create</p>
<p>an instance of the generic ConfigVariable class,for the purpose of</p>
<p>querying an existing variable only (you should notdefine a new</p>
<p>variable using the generic class).</p>
<p>To find out more detail about a variable and itsvalue, use the ls()</p>
<p>method in Python (or the write() method in C++),e.g.:</p>
<p>ConfigVariable(&#8220;foo-level&#8221;).ls()</p>
<p>In addition to the variable&#8217;s current and defaultvalues, this also</p>
<p>prints a list of all of the prc files thatcontributed to the value of</p>
<p>the variable, as well as the description providedfor the variable.</p>
<p>To get a list of all known config variables, usethe methods on</p>
<p>ConfigVariableManager.  In C++, you can get apointer this object via</p>
<p>ConfigVariableManager::get_global_ptr(); inPython, use the cvMgr</p>
<p>builtin, created by ShowBase.py.</p>
<p>print cvMgr</p>
<p>​    Lists all of the variables in active use: allof the variables</p>
<p>​    whose value has been set by one or more prcfiles, along with the</p>
<p>​    name of the prc file that defines that value.</p>
<p>cvMgr.listVariables()</p>
<p>​    Lists all of the variables currently known tothe config system;</p>
<p>​    that is, all variables for which aConfigVariable instance has</p>
<p>​    been created at runtime, whether or not itsvalue has been changed</p>
<p>​    from the default.  This may omit variablesdefined in some unused</p>
<p>​    subsystem (like pandaegg, for instance), andit will omit</p>
<p>​    variables defined by Python code which hasn&#8217;tyet been executed</p>
<p>​    (e.g. variables within defined with a functionthat hasn&#8217;t yet  been called).</p>
<p>This will also omit variables deemed to be&#8221;dynamic&#8221; variables,</p>
<p>​    for instance all of the notify-level-*variables, and variables</p>
<p>​    such as pstats-active-*.  These are omittedsimply to keep the</p>
<p>​    list of variable names manageable, since thelist of dynamic</p>
<p>​    variable names tends to be very large.  Use</p>
<p>​    cvMgr.listDynamicVariables() if you want tosee these variable</p>
<p>​    names.</p>
<p>cvMgr.listUnusedVariables()</p>
<p>​    Lists all of the variables that have beendefined by some prc</p>
<p>​    file, but which are not known to the configsystem (no</p>
<p>​    ConfigVariable instance has yet been createdfor this variable).</p>
<p>​    These variables may represent misspellings ortypos in your prc</p>
<p>​    file, or they may be old variables which areno longer used in the</p>
<p>​    system.  However, they may also be legitimatevariables for some</p>
<p>​    subsystem or application which simply has notbeen loaded; there</p>
<p>​    is no way for Panda to make this distinction.</p>
</div>
<div class="section" id="re-reading-prc-files">
<span id="re-reading-prc-files"></span><h3>Re-reading prc files<a class="headerlink" href="#re-reading-prc-files" title="Permalink to this headline">¶</a></h3>
<p>If you modify a prc file at some point after Pandahas started, Panda</p>
<p>will not automatically know that it needs toreload its config files</p>
<p>and will not therefore automatically recognizeyour change.  However,</p>
<p>you can force this to happen by making thefollowing call:</p>
<p>ConfigPageManager::get_global_ptr()-&gt;reload_implicit_pages()</p>
<p>Or, in Python:</p>
<p>cpMgr.reloadImplicitPages()</p>
<p>This will tell Panda to re-read all of the prcfiles it found</p>
<p>automatically at startup and update the variables&#8217;values accordingly.</p>
</div>
<div class="section" id="runtime-prc-file-management">
<span id="runtime-prc-file-management"></span><h3>Runtime prc file management<a class="headerlink" href="#runtime-prc-file-management" title="Permalink to this headline">¶</a></h3>
<p>In addition to the prc files that are found andloaded automatically by Panda at startup, you can load files up atruntime as needed.  The</p>
<p>functions to manage this are defined inload_prc_file.h:</p>
<p>ConfigPage *page = load_prc_file(&#8220;myPage.prc&#8221;)</p>
<p>...</p>
<p>unload_prc_file(page);</p>
<p>(The above shows the C++ syntax; the correspondingPython code is</p>
<p>similar, but of course the functions are namedloadPrcFile() and</p>
<p>unloadPrcFile().)</p>
<p>That is to say, you can call load_prc_file() toload up a new prc file</p>
<p>at any time.  Each file you load is added to aLIFO stack of prc</p>
<p>files.  If a variable is defined in more than oneprc file, the</p>
<p>topmost file on the stack (i.e. the one mostrecently loaded) is the</p>
<p>one that defines the variable&#8217;s value.</p>
<p>You can call unload_prc_file() at any time tounload a file that you</p>
<p>have previously loaded.  This removes the filefrom the stack and</p>
<p>allows any variables it modified to return totheir previous value.</p>
<p>The single parameter to unload_prc_file() shouldbe the pointer that</p>
<p>was returned from the corresponding call toload_prc_file().  Once you</p>
<p>have called unload_prc_file(), the pointer isinvalid and should no</p>
<p>longer be used.  It is an error to callunload_prc_file() twice on the</p>
<p>same pointer.</p>
<p>The filename passed to load_prc_file() may referto any file that is</p>
<p>on the standard prc file search path (e.g.$PRC_DIR), as well as on</p>
<p>the model-path.  It may be a physical file ondisk, or a subfile of a</p>
<p>multifile (and mounted via Panda&#8217;s virtual filesystem).</p>
<p>If your prc file is stored as an in-memory stringinstead of as a disk</p>
<p>file (for instance, maybe you just built it up),you can use the</p>
<p>load_prc_file_data() method to load the prc filefrom the string data.</p>
<p>The first parameter is an arbitrary name to assignto your in-memory</p>
<p>prc file; supply a filename if you have one, oruse some other name</p>
<p>that is meaningful to you.</p>
<p>You can see the complete list of prc files thathave been loaded into</p>
<p>the config system at any given time, includingfiles loaded explicitly</p>
<p>via load_prc_file(), as well as files found in thestandard prc file</p>
<p>search path and loaded implicitly at startup. Simply use</p>
<p>ConfigPageManager::write(), e.g. in Python:</p>
<p>print cpMgr</p>
</div>
<div class="section" id="compile-time-options-for-finding-prc-files">
<span id="compile-time-options-for-finding-prc-files"></span><h3>Compile-time options for finding prc files<a class="headerlink" href="#compile-time-options-for-finding-prc-files" title="Permalink to this headline">¶</a></h3>
<p>As described above in USING THE PRC FILES, Panda&#8217;s default startup</p>
<p>behavior is to load all files named *.prc in the directory named by</p>
<p>the environment variable PRC_DIR.  This isactually a bit of an</p>
<p>oversimplification.  The complete default behavioris as follows:</p>
<p>(1) If PRC_PATH is set, separate it into a list ofdirectories and</p>
<p>​    make a search path out of it.</p>
<p>(2) If PRC_DIR is set, prepend it onto the searchpath defined by</p>
<p>​    PRC_PATH, above.</p>
<p>(3) If neither was set, put the compiled-in valuefor DEFAULT_PRC_DIR,</p>
<p>​    which is usually the install/etc directory,alone on the search</p>
<p>​    path.</p>
<p>​    Steps (1), (2), and (3) define what isreferred to in this</p>
<p>​    document as &#8220;the standard prc searchpath&#8221;.  You can query this</p>
<p>​    search path via cpMgr.getSearchPath().</p>
<p>(4) Look for all files named *.prc on eachdirectory of the resulting</p>
<p>​    search path, and load them up in reversesearch path order, and</p>
<p>​    within each directory, in forward alphabeticalorder.  This means</p>
<p>​    that directories listed first on the searchpath override</p>
<p>​    directories listed later, and within adirectory, files</p>
<p>​    alphabetically later override filesalphabetically earlier.</p>
<p>This describes the default behavior, without anymodifications to</p>
<p>Config.pp.  If you wish, you can further fine-tuneeach of the above</p>
<p>steps by defining various Config.pp variables atcompile time.  The</p>
<p>following Config.pp variables may be defined:</p>
<p>#define PRC_PATH_ENVVARS PRC_PATH</p>
<p>#define PRC_DIR_ENVVARS PRC_DIR</p>
<p>These name the environment variable(s) to useinstead of PRC_PATH</p>
<p>and PRC_DIR.  In either case, you may namemultiple environment</p>
<p>variables separated by a space; each variable isconsulted one at a</p>
<p>time, in the order named, and the results areconcatenated.</p>
<p>For instance, if you put the following line inyour Config.pp file:</p>
<p>#define PRC_PATH_ENVVARS CFG_PATH ETC_PATH</p>
<p>Then instead of checking $PRC_PATH in step (1),above, Panda will</p>
<p>first check $CFG_PATH, and then $ETC_PATH, andthe final search path</p>
<p>will be the concatenation of both.</p>
<p>You can also define either or both ofPRC_PATH_ENVVARS or</p>
<p>PRC_DIR_ENVVARS to the empty string; this willdisable runtime</p>
<p>checking of environment variables, and force allprc files to be</p>
<p>loaded from the directory named byDEFAULT_PRC_DIR.</p>
<p>#define PRC_PATTERNS *.prc</p>
<p>This describes the filename patterns that areused to identify prc</p>
<p>files in each directory in step(4), above.  Thedefault is *.prc,</p>
<p>but you can change this if you have any reasonto.  You can specify</p>
<p>multiple filename patterns separated by a space. For instance, if</p>
<p>you still have some config files named&#8221;Configrc&#8221;, following an</p>
<p>older Panda convention, you can define thefollowing in your</p>
<p>Config.pp file:</p>
<p>#define PRC_PATTERNS *.prc Configrc</p>
<p>This will cause Panda to recognize files named&#8221;Configrc&#8221;, as well</p>
<p>as any file ending in the extension prc, as alegitimate prc file.</p>
<p>#define DEFAULT_PRC_DIR $[INSTALL_DIR]/etc</p>
<p>This is the directory from which to load prcfiles if all of the</p>
<p>variables named by PRC_PATH_ENVVARS andPRC_DIR_ENVVARS are</p>
<p>undefined or empty.</p>
<p>#define DEFAULT_PATHSEP</p>
<p>This doesn&#8217;t strictly apply to the configsystem, since it globally</p>
<p>affects search paths throughout Panda.  Thisspecifies the character</p>
<p>or characters used to separate the differentdirectory names of a</p>
<p>search path, for instance $PRC_PATH.  Thedefault character is &#8216;:&#8217;</p>
<p>on Unix, and &#8216;;&#8217; on Windows.  If you specifymultiple characters,</p>
<p>any of them may be used as a separator.</p>
</div>
<div class="section" id="executable-prc-files">
<span id="executable-prc-files"></span><h3>Executable prc files<a class="headerlink" href="#executable-prc-files" title="Permalink to this headline">¶</a></h3>
<p>One esoteric feature of Panda&#8217;s config system isthe ability to</p>
<p>automatically execute a standalone program whichgenerates a prc file</p>
<p>as output.</p>
<p>This feature is not enabled by default.  To enableit, you must define</p>
<p>the Config.pp variable PRC_EXECUTABLE_PATTERNSbefore you build Panda.</p>
<p>This variable is similar to PRC_PATTERNS,described above, except it</p>
<p>names file names which, when found along thestandard prc search path,</p>
<p>should be taken to be the name of an executableprogram.  Panda will</p>
<p>execute each of these programs, in the appropriateorder according to</p>
<p>alphabetical sorting with the regular prc files,and whatever the</p>
<p>program writes to standard output is taken to bethe contents of a prc</p>
<p>file.</p>
<p>By default the contents of the environmentvariable</p>
<p>$PRC_EXECUTABLE_ARGS are passed as arguments tothe executable</p>
<p>program.  You can change this to a differentenvironment variable by</p>
<p>redefining PRC_EXECUTABLE_ARGS_ENVVAR in yourConfig.pp (or prevent</p>
<p>the passing of arguments by defining this to theempty string).</p>
</div>
<div class="section" id="signed-prc-files">
<span id="signed-prc-files"></span><h3>Signed prc files<a class="headerlink" href="#signed-prc-files" title="Permalink to this headline">¶</a></h3>
<p>Another esoteric feature of Panda&#8217;s config systemis the ability to</p>
<p>restrict certain config variables to modificationonly by a prc file</p>
<p>that has been provided by an authorized source. This is primarily</p>
<p>useful when Panda is to be used for deployment ofapplications (games,</p>
<p>etc.) to a client; it has little utility in afully trusted</p>
<p>environment.</p>
<p>When this feature is enabled, you can specify anoptional trust level</p>
<p>to each ConfigVariable constructor.  The trustlevel is an integer</p>
<p>value, greater than 0 (and &lt;=ConfigFlags::F_trust_level_mask), which</p>
<p>should be or&#8217;ed in with the flags parameter.</p>
<p>A number of random keys must be generated ahead oftime and compiled</p>
<p>into Panda; there must be a different key for eachdifferent trust</p>
<p>level.  Each prc file can then optionally besigned by exactly one of</p>
<p>the available keys.  When a prc file has beensigned by a recognized</p>
<p>key, Panda assigns the corresponding trust levelto that prc file.  An</p>
<p>unsigned prc file has an implicit trust level of0.</p>
<p>If a signed prc file is modified in any way afterit has been signed,</p>
<p>its signature will no longer match the contents ofthe file and its</p>
<p>trust level drops to 0.  The newly-modified filemust be signed again</p>
<p>to restore its trust level.</p>
<p>When a ConfigVariable is constructed with anonzero trust level, that</p>
<p>variable&#8217;s value may then not be set by any prcfile with a trust</p>
<p>level lower that the variable&#8217;s trust level.  If aprc file with an</p>
<p>insufficient trust level attempts to modify thevariable, the new</p>
<p>value is ignored, and the value from the previoustrusted prc file (or</p>
<p>the variable&#8217;s default value) is retained.</p>
<p>The default trust level for a ConfigVariable is 0,which means the</p>
<p>variable can be set by any prc file, signed orunsigned.  To set any</p>
<p>nonzero trust level, pass the integer trust levelvalue as the flags</p>
<p>parameter to the ConfigVariable constructor.  Toexplicitly specify a</p>
<p>trust level of 0, pass ConfigFlags::F_open.</p>
<p>To specify a ConfigVariable that cannot be set byany prc files at</p>
<p>all, regardless of trust level, useConfigFlags::F_closed.</p>
<p>This feature is not enabled by default.  It issomewhat complicated to</p>
<p>enable this feature, because doing so requresgenerating one or more</p>
<p>private/public key pairs, and compiling the publickeys into the</p>
<p>low-level Panda system so that it can recognizesigned prc files when</p>
<p>they are provided, and compiling the private keysinto standalone</p>
<p>executables, one for each private key, that can beused to officially</p>
<p>sign approved prc files.  This initial setuptherefore requires a bit</p>
<p>of back-and-forth building and rebuilding in thedtool directory.</p>
<p>To enable this feature, follow the followingprocedure.</p>
<p>(1) Decide how many different trust levels yourequire.  You can have</p>
<p>​    as many as you want, but most applicationswill require only one</p>
<p>​    trust level, or possibly two.  The rareapplication will require</p>
<p>​    three or more.  If you decide to use multipletrust levels, you</p>
<p>​    can make a distinction between configvariables that are somewhat</p>
<p>​    sensitive and those that are highly sensitive.</p>
<p>(2) Obtain and install the OpenSSL library, if itis not already</p>
<p>​    installed (http://www.openssl.org).  Adjustyour Config.pp file as</p>
<p>​    necessary to point to the installed OpenSSLheaders and libraries</p>
<p>​    (in particular, define SSL_IPATH andSSL_LIBS), and then ppremake</p>
<p>​    and make install your dtool tree.  It is notnecessary to build</p>
<p>​    the panda tree or any subsequent trees yet.</p>
<p>(3) Set up a directory to hold the generatedpublic keys.  The</p>
<p>​    contents of this directory must be accessibleto anyone building</p>
<p>​    Panda for your application; it also must havea lifetime at least</p>
<p>​    as long as the lifetime of your application. It probably makes</p>
<p>​    sense to make this directory part of yourapplication&#8217;s source</p>
<p>​    tree.  The contents of this directory will notbe particularly</p>
<p>​    sensitive and need not be kept any more secretthan the rest of</p>
<p>​    your application&#8217;s source code.</p>
<p>(4) Set up a directory in a secure place to holdthe generated private</p>
<p>​    keys.  The contents of this directory shouldbe regarded as</p>
<p>​    somewhat sensitive, and should not beavailable to more than a</p>
<p>​    manageable number of developers.  It need notbe accessible to</p>
<p>​    people building Panda.  However, thisdirectory should have a</p>
<p>​    lifetime as long as the lifetime of yourapplication.  Depending</p>
<p>​    on your environment, it may or may not makesense to make this</p>
<p>​    directory a part of your application&#8217;s sourcetree; it can be the</p>
<p>​    same directory as that chosen for (3), above.</p>
<p>(5) Run the program make-prc-key.  This programgenerates the public</p>
<p>​    and private key pairs for each of your trustlevels.  The</p>
<p>​    following is an example:</p>
<p>​    make-prc-key -a <pubdir>/keys.cxx -b<privdir>/sign#.cxx 1 2</p>
<p>​    The output of make-prc-key will be compilableC++ source code.</p>
<p>​    The first parameter, -a, specifies the name ofthe public key</p>
<p>output file.  This file will contain all of thepublic keys for</p>
<p>​    the different trust levels, and will becomepart of the libdtool</p>
<p>​    library.  It is not particularly sensitive,and must be accessible</p>
<p>​    to anyone who will be compiling dtool.</p>
<p>​    The second parameter, -b, specifies acollection of output files,</p>
<p>​    one for each trust level.  Each file can becompiled as a</p>
<p>​    standalone program (that links with libdtool);the resulting</p>
<p>​    program can then be used to sign any prc fileswith the</p>
<p>​    corresponding trust level.  The hash character&#8217;#&#8217; appearing in</p>
<p>​    the filename will be filled in with thenumeric trust level.</p>
<p>​    The remaining arguments to make-prc-key arethe list of trust</p>
<p>​    levels to generate key pairs for.  In theexample above, we are</p>
<p>​    generating two key pairs, for trust level 1and for trust level 2.</p>
<p>​    The program will prompt you to enter a passphrase for each</p>
<p>​    private key.  This pass phrase is used toencrypt the private key</p>
<p>​    as written into the output file, to reduce thesensitivity of the</p>
<p>​    prc signing program (and its source code). The user of the</p>
<p>​    signing program must re-enter this pass phrasein order to sign a</p>
<p>​    prc file.  You may specify a different passphrase for each trust</p>
<p>​    level, or you may use the -p &#8220;passphrase&#8221; command-line option to</p>
<p>​    provide the same pass phrase for all trustlevels.  If you do not</p>
<p>​    want to use the pass phrase feature at all,use -p &#8220;&#8221;, and keep</p>
<p>​    the generated programs in a safe place.</p>
<p>(6) Modify your Config.pp file (for yourself, andfor anyone else who</p>
<p>​    will be building dtool for your application)to add the following</p>
<p>​    line:</p>
<p>​    #define PRC_PUBLIC_KEYS_FILENAME<pubdir>/keys.cxx</p>
<p>​    Where <pubdir>/keys.cxx is the filenamed by -a, above.</p>
<p>​    Consider whether you want to enforce the trustlevel in the</p>
<p>​    development environment.  The default is torespect the trust</p>
<p>​    level only when Panda is compiled for arelease build, i.e. when</p>
<p>​    OPTIMIZE is set to 4.  You can redefinePRC_RESPECT_TRUST_LEVEL if</p>
<p>​    you want to change this default behavior.</p>
<p>​    Re-run ppremake and then make install indtool.</p>
<p>(7) Set up a Sources.pp file in your private keydirectory to compile</p>
<p>​    the files named by -b against dtool.  Itshould contain an entry</p>
<p>​    something like these for each trust level:</p>
<p>​</p>
<p>​    #begin bin_target</p>
<p>​      #define OTHER_LIBS dtool</p>
<p>​      #define USE_PACKAGES ssl</p>
<p>​      #define TARGET sign1</p>
<p>​      #define SOURCES sign1.cxx</p>
<p>​    #end bin_target</p>
<p>​    #begin bin_target</p>
<p>​      #define OTHER_LIBS dtool</p>
<p>​      #define USE_PACKAGES ssl</p>
<p>​      #define TARGET sign2</p>
<p>​      #define SOURCES sign2.cxx</p>
<p>​    #end bin_target</p>
<p>(8) If your private key directory is not a part ofyour application</p>
<p>​    source hierarchy (or your application does notuse ppremake),</p>
<p>​    create a Package.pp in the same directory tomark the root of a</p>
<p>​    ppremake source tree.  You can simply copy thePackage.pp file</p>
<p>​    from panda/Package.pp.  You do not need to dothis if your private</p>
<p>​    key directory is already part of appremake-controlled source</p>
<p>​    hierarchy.</p>
<p>(9) Run ppremake and then make install in theprivate key directory.</p>
<p>​    This will generate the programs sign1 andsign2 (or whatever you</p>
<p>​    have named them).  Distribute these programsto the appropriate</p>
<p>​    people who have need to sign prc files, andtell them the pass</p>
<p>​    phrases that you used to generate them.</p>
<p>(10) Build the rest of the Panda trees normally.</p>
<p>Advanced tip: if you follow the directions above,your sign1 and sign2</p>
<p>programs will require libdtool.dll at runtime, andmay need to be</p>
<p>recompiled from time to time if you get a newversion of dtool.  To</p>
<p>avoid this, you can link these programsstatically, so that they are</p>
<p>completely standalone.  This requires one moreback-and-forth</p>
<p>rebuilding of dtool:</p>
<p>(a) Put the following line in your Config.pp file:</p>
<p>#define LINK_ALL_STATIC 1</p>
<p>(b) Run ppremake and make clean install in dtool. Note that you must</p>
<p>​    make clean.  This will generate a staticversion of libdtool.lib.</p>
<p>(c) Run ppremake and make clean install in yourprivate key directory,</p>
<p>​    to recompile the sign programs against the newstatic libdtool.lib.</p>
<p>(d) Remove (or comment out) the LINK_ALL_STATICline in your Config.pp</p>
<p>​    file.</p>
<p>(e) Run ppremake and make clean install in dtoolto restore the normal</p>
<p>​    dynamic library, so that future builds ofpanda and the rest of</p>
<p>​    your application will use the dynamiclibdtool.dll properly.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="misc and FAQ.html" class="btn btn-neutral float-right" title="Miscellaneous and F.A.Q." accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="source tree.html" class="btn btn-neutral" title="Source tree" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Public Domain.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>